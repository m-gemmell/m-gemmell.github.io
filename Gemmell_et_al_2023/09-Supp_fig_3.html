<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 9 Supp figure 3 | Optimised human stool sample collection for multi-omic microbiota analysis R code</title>
  <meta name="description" content="Book to contain visualisation for the “ANCOM” project" />
  <meta name="generator" content="bookdown 0.36 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 9 Supp figure 3 | Optimised human stool sample collection for multi-omic microbiota analysis R code" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Book to contain visualisation for the “ANCOM” project" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 9 Supp figure 3 | Optimised human stool sample collection for multi-omic microbiota analysis R code" />
  
  <meta name="twitter:description" content="Book to contain visualisation for the “ANCOM” project" />
  

<meta name="author" content="Matthew R. Gemmell" />


<meta name="date" content="2024-07-12" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="08-Supp_fig_2.html"/>
<link rel="next" href="10-Supp_fig_4.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.6.2/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.28/datatables.js"></script>
<link href="libs/dt-core-1.13.4/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.13.4/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.13.4/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a>Optimised human stool sample collection for multi-omic microbiota analysis R code</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="01-Intro.html"><a href="01-Intro.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="02-Phyloseqize.html"><a href="02-Phyloseqize.html"><i class="fa fa-check"></i><b>2</b> Importing and preocessing data</a>
<ul>
<li class="chapter" data-level="2.1" data-path="02-Phyloseqize.html"><a href="02-Phyloseqize.html#qiime2r-import"><i class="fa fa-check"></i><b>2.1</b> qiime2R import</a></li>
<li class="chapter" data-level="2.2" data-path="02-Phyloseqize.html"><a href="02-Phyloseqize.html#preprocess-data"><i class="fa fa-check"></i><b>2.2</b> Preprocess data</a></li>
<li class="chapter" data-level="2.3" data-path="02-Phyloseqize.html"><a href="02-Phyloseqize.html#lipid-data"><i class="fa fa-check"></i><b>2.3</b> Lipid data</a></li>
</ul></li>
<li class="part"><span><b>Main figures</b></span></li>
<li class="chapter" data-level="3" data-path="03-Figure_3.html"><a href="03-Figure_3.html"><i class="fa fa-check"></i><b>3</b> Figure 3</a>
<ul>
<li class="chapter" data-level="3.1" data-path="03-Figure_3.html"><a href="03-Figure_3.html#libraries"><i class="fa fa-check"></i><b>3.1</b> Libraries</a></li>
<li class="chapter" data-level="3.2" data-path="03-Figure_3.html"><a href="03-Figure_3.html#figure-3a"><i class="fa fa-check"></i><b>3.2</b> Figure 3A</a></li>
<li class="chapter" data-level="3.3" data-path="03-Figure_3.html"><a href="03-Figure_3.html#figure-3b"><i class="fa fa-check"></i><b>3.3</b> Figure 3B</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="03-Figure_3.html"><a href="03-Figure_3.html#percentage-of-bacteroides-and-firmicutes"><i class="fa fa-check"></i><b>3.3.1</b> Percentage of Bacteroides and Firmicutes</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="03-Figure_3.html"><a href="03-Figure_3.html#figure-3c"><i class="fa fa-check"></i><b>3.4</b> Figure 3C</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="04-Figure_4.html"><a href="04-Figure_4.html"><i class="fa fa-check"></i><b>4</b> Figure 4</a>
<ul>
<li class="chapter" data-level="4.1" data-path="04-Figure_4.html"><a href="04-Figure_4.html#libraries-1"><i class="fa fa-check"></i><b>4.1</b> Libraries</a></li>
<li class="chapter" data-level="4.2" data-path="04-Figure_4.html"><a href="04-Figure_4.html#genus"><i class="fa fa-check"></i><b>4.2</b> Genus</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="04-Figure_4.html"><a href="04-Figure_4.html#preprocess-table-and-convert-to-genus-table"><i class="fa fa-check"></i><b>4.2.1</b> Preprocess table and convert to genus table</a></li>
<li class="chapter" data-level="4.2.2" data-path="04-Figure_4.html"><a href="04-Figure_4.html#maaslin2-on-genera"><i class="fa fa-check"></i><b>4.2.2</b> MaAsLin2 on genera</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="05-Figure_5.html"><a href="05-Figure_5.html"><i class="fa fa-check"></i><b>5</b> Figure 5</a>
<ul>
<li class="chapter" data-level="5.1" data-path="05-Figure_5.html"><a href="05-Figure_5.html#libraries-2"><i class="fa fa-check"></i><b>5.1</b> libraries</a></li>
<li class="chapter" data-level="5.2" data-path="05-Figure_5.html"><a href="05-Figure_5.html#preprocess-data-1"><i class="fa fa-check"></i><b>5.2</b> Preprocess data</a></li>
<li class="chapter" data-level="5.3" data-path="05-Figure_5.html"><a href="05-Figure_5.html#colour-blindy-friendly-palettes"><i class="fa fa-check"></i><b>5.3</b> Colour blindy friendly palettes</a></li>
<li class="chapter" data-level="5.4" data-path="05-Figure_5.html"><a href="05-Figure_5.html#a-heatmap"><i class="fa fa-check"></i><b>5.4</b> A Heatmap</a></li>
<li class="chapter" data-level="5.5" data-path="05-Figure_5.html"><a href="05-Figure_5.html#b-c"><i class="fa fa-check"></i><b>5.5</b> B &amp; C</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="05-Figure_5.html"><a href="05-Figure_5.html#b-pcoa-plot"><i class="fa fa-check"></i><b>5.5.1</b> B PCoA plot</a></li>
<li class="chapter" data-level="5.5.2" data-path="05-Figure_5.html"><a href="05-Figure_5.html#c-pcoa-plot"><i class="fa fa-check"></i><b>5.5.2</b> C PCoA plot</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="05-Figure_5.html"><a href="05-Figure_5.html#without-ethanol"><i class="fa fa-check"></i><b>5.6</b> Without ethanol</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="06-Figure_6.html"><a href="06-Figure_6.html"><i class="fa fa-check"></i><b>6</b> Figure 6</a>
<ul>
<li class="chapter" data-level="6.1" data-path="06-Figure_6.html"><a href="06-Figure_6.html#libraries-3"><i class="fa fa-check"></i><b>6.1</b> Libraries</a></li>
<li class="chapter" data-level="6.2" data-path="06-Figure_6.html"><a href="06-Figure_6.html#preprocess-tables"><i class="fa fa-check"></i><b>6.2</b> Preprocess tables</a></li>
<li class="chapter" data-level="6.3" data-path="06-Figure_6.html"><a href="06-Figure_6.html#all-buffers"><i class="fa fa-check"></i><b>6.3</b> All buffers</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="06-Figure_6.html"><a href="06-Figure_6.html#correlation"><i class="fa fa-check"></i><b>6.3.1</b> Correlation</a></li>
<li class="chapter" data-level="6.3.2" data-path="06-Figure_6.html"><a href="06-Figure_6.html#heatmap"><i class="fa fa-check"></i><b>6.3.2</b> Heatmap</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>Supplementary figures</b></span></li>
<li class="chapter" data-level="7" data-path="07-Supp_fig_1.html"><a href="07-Supp_fig_1.html"><i class="fa fa-check"></i><b>7</b> Supp figure 1</a>
<ul>
<li class="chapter" data-level="7.1" data-path="07-Supp_fig_1.html"><a href="07-Supp_fig_1.html#libraries-4"><i class="fa fa-check"></i><b>7.1</b> Libraries</a></li>
<li class="chapter" data-level="7.2" data-path="07-Supp_fig_1.html"><a href="07-Supp_fig_1.html#rarefactipon-plot"><i class="fa fa-check"></i><b>7.2</b> Rarefactipon plot</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="08-Supp_fig_2.html"><a href="08-Supp_fig_2.html"><i class="fa fa-check"></i><b>8</b> Supp figure 2</a>
<ul>
<li class="chapter" data-level="8.1" data-path="08-Supp_fig_2.html"><a href="08-Supp_fig_2.html#libraries-5"><i class="fa fa-check"></i><b>8.1</b> Libraries</a></li>
<li class="chapter" data-level="8.2" data-path="08-Supp_fig_2.html"><a href="08-Supp_fig_2.html#weighted-unifrac-plots-with-relative-abundance"><i class="fa fa-check"></i><b>8.2</b> Weighted unifrac plots with relative abundance</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="08-Supp_fig_2.html"><a href="08-Supp_fig_2.html#figure-a-buffer-used-faceted-by-patient"><i class="fa fa-check"></i><b>8.2.1</b> Figure A: Buffer used faceted by patient</a></li>
<li class="chapter" data-level="8.2.2" data-path="08-Supp_fig_2.html"><a href="08-Supp_fig_2.html#figure-b-storage-temperature"><i class="fa fa-check"></i><b>8.2.2</b> Figure B: Storage temperature</a></li>
<li class="chapter" data-level="8.2.3" data-path="08-Supp_fig_2.html"><a href="08-Supp_fig_2.html#figure-c-storage-conditions"><i class="fa fa-check"></i><b>8.2.3</b> Figure C: Storage conditions</a></li>
<li class="chapter" data-level="8.2.4" data-path="08-Supp_fig_2.html"><a href="08-Supp_fig_2.html#figure-d-buffer-and-storage-condition-faceted-by-patient"><i class="fa fa-check"></i><b>8.2.4</b> Figure D: Buffer and storage condition faceted by patient</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="09-Supp_fig_3.html"><a href="09-Supp_fig_3.html"><i class="fa fa-check"></i><b>9</b> Supp figure 3</a>
<ul>
<li class="chapter" data-level="9.1" data-path="09-Supp_fig_3.html"><a href="09-Supp_fig_3.html#libraries-6"><i class="fa fa-check"></i><b>9.1</b> Libraries</a></li>
<li class="chapter" data-level="9.2" data-path="09-Supp_fig_3.html"><a href="09-Supp_fig_3.html#s-composition"><i class="fa fa-check"></i><b>9.2</b> 16S composition</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="09-Supp_fig_3.html"><a href="09-Supp_fig_3.html#table-of-all-paired-distances"><i class="fa fa-check"></i><b>9.2.1</b> Table of all paired distances</a></li>
<li class="chapter" data-level="9.2.2" data-path="09-Supp_fig_3.html"><a href="09-Supp_fig_3.html#extract-the-paired-distances"><i class="fa fa-check"></i><b>9.2.2</b> Extract the paired distances</a></li>
<li class="chapter" data-level="9.2.3" data-path="09-Supp_fig_3.html"><a href="09-Supp_fig_3.html#buffer-deep-dive"><i class="fa fa-check"></i><b>9.2.3</b> Buffer deep dive</a></li>
<li class="chapter" data-level="9.2.4" data-path="09-Supp_fig_3.html"><a href="09-Supp_fig_3.html#combined-plot"><i class="fa fa-check"></i><b>9.2.4</b> Combined plot</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="10-Supp_fig_4.html"><a href="10-Supp_fig_4.html"><i class="fa fa-check"></i><b>10</b> Supp figure 4</a>
<ul>
<li class="chapter" data-level="10.1" data-path="10-Supp_fig_4.html"><a href="10-Supp_fig_4.html#libraries-7"><i class="fa fa-check"></i><b>10.1</b> Libraries</a></li>
<li class="chapter" data-level="10.2" data-path="10-Supp_fig_4.html"><a href="10-Supp_fig_4.html#alpha-diveristy-plots"><i class="fa fa-check"></i><b>10.2</b> Alpha diveristy plots</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="10-Supp_fig_4.html"><a href="10-Supp_fig_4.html#a-storage-conditions"><i class="fa fa-check"></i><b>10.2.1</b> A: Storage conditions</a></li>
<li class="chapter" data-level="10.2.2" data-path="10-Supp_fig_4.html"><a href="10-Supp_fig_4.html#b-participant-number"><i class="fa fa-check"></i><b>10.2.2</b> B: Participant number</a></li>
<li class="chapter" data-level="10.2.3" data-path="10-Supp_fig_4.html"><a href="10-Supp_fig_4.html#c-storage-temp"><i class="fa fa-check"></i><b>10.2.3</b> C: Storage temp</a></li>
<li class="chapter" data-level="10.2.4" data-path="10-Supp_fig_4.html"><a href="10-Supp_fig_4.html#d-buffer-and-storage"><i class="fa fa-check"></i><b>10.2.4</b> D: Buffer and storage</a></li>
<li class="chapter" data-level="10.2.5" data-path="10-Supp_fig_4.html"><a href="10-Supp_fig_4.html#e-buffer-and-participant"><i class="fa fa-check"></i><b>10.2.5</b> E: Buffer and participant</a></li>
<li class="chapter" data-level="10.2.6" data-path="10-Supp_fig_4.html"><a href="10-Supp_fig_4.html#f-storage-condition-and-participant"><i class="fa fa-check"></i><b>10.2.6</b> F: storage condition and participant</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="11-Supp_fig_5.html"><a href="11-Supp_fig_5.html"><i class="fa fa-check"></i><b>11</b> Supp figure 5</a>
<ul>
<li class="chapter" data-level="11.1" data-path="11-Supp_fig_5.html"><a href="11-Supp_fig_5.html#libraries-8"><i class="fa fa-check"></i><b>11.1</b> Libraries</a></li>
<li class="chapter" data-level="11.2" data-path="11-Supp_fig_5.html"><a href="11-Supp_fig_5.html#barchart-of-genera-biomarkers"><i class="fa fa-check"></i><b>11.2</b> Barchart of Genera biomarkers</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="12-Supp_fig_6.html"><a href="12-Supp_fig_6.html"><i class="fa fa-check"></i><b>12</b> Supp figure 6</a>
<ul>
<li class="chapter" data-level="12.1" data-path="12-Supp_fig_6.html"><a href="12-Supp_fig_6.html#intra-group-variability"><i class="fa fa-check"></i><b>12.1</b> Intra group variability</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="13-Supp_fig_7.html"><a href="13-Supp_fig_7.html"><i class="fa fa-check"></i><b>13</b> Supp figure 7</a>
<ul>
<li class="chapter" data-level="13.1" data-path="13-Supp_fig_7.html"><a href="13-Supp_fig_7.html#libraries-9"><i class="fa fa-check"></i><b>13.1</b> Libraries</a></li>
<li class="chapter" data-level="13.2" data-path="13-Supp_fig_7.html"><a href="13-Supp_fig_7.html#scfa-analysis"><i class="fa fa-check"></i><b>13.2</b> SCFA analysis</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="13-Supp_fig_7.html"><a href="13-Supp_fig_7.html#table-of-all-paired-distances-1"><i class="fa fa-check"></i><b>13.2.1</b> Table of all paired distances</a></li>
<li class="chapter" data-level="13.2.2" data-path="13-Supp_fig_7.html"><a href="13-Supp_fig_7.html#extract-the-paired-distances-1"><i class="fa fa-check"></i><b>13.2.2</b> Extract the paired distances</a></li>
<li class="chapter" data-level="13.2.3" data-path="13-Supp_fig_7.html"><a href="13-Supp_fig_7.html#buffer-deep-dive-1"><i class="fa fa-check"></i><b>13.2.3</b> Buffer deep dive</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="13-Supp_fig_7.html"><a href="13-Supp_fig_7.html#combine-plots"><i class="fa fa-check"></i><b>13.3</b> Combine plots</a></li>
</ul></li>
<li class="part"><span><b>Supplementary tables</b></span></li>
<li class="chapter" data-level="14" data-path="14-Supp_table_2.html"><a href="14-Supp_table_2.html"><i class="fa fa-check"></i><b>14</b> Supp table 2</a>
<ul>
<li class="chapter" data-level="14.1" data-path="14-Supp_table_2.html"><a href="14-Supp_table_2.html#libraries-10"><i class="fa fa-check"></i><b>14.1</b> Libraries</a>
<ul>
<li class="chapter" data-level="14.1.1" data-path="14-Supp_table_2.html"><a href="14-Supp_table_2.html#statistical-test"><i class="fa fa-check"></i><b>14.1.1</b> Statistical test</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="15" data-path="15-Supp_table_3.html"><a href="15-Supp_table_3.html"><i class="fa fa-check"></i><b>15</b> Supp table 3</a>
<ul>
<li class="chapter" data-level="15.1" data-path="15-Supp_table_3.html"><a href="15-Supp_table_3.html#libraries-11"><i class="fa fa-check"></i><b>15.1</b> Libraries</a>
<ul>
<li class="chapter" data-level="15.1.1" data-path="15-Supp_table_3.html"><a href="15-Supp_table_3.html#paired-wilcox-tests"><i class="fa fa-check"></i><b>15.1.1</b> Paired wilcox tests</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="16" data-path="16-Supp_table_4.html"><a href="16-Supp_table_4.html"><i class="fa fa-check"></i><b>16</b> Supp table 4</a>
<ul>
<li class="chapter" data-level="16.1" data-path="16-Supp_table_4.html"><a href="16-Supp_table_4.html#libraries-12"><i class="fa fa-check"></i><b>16.1</b> Libraries</a></li>
<li class="chapter" data-level="16.2" data-path="16-Supp_table_4.html"><a href="16-Supp_table_4.html#significant-results-table"><i class="fa fa-check"></i><b>16.2</b> Significant results table</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="17-Supp_table_6.html"><a href="17-Supp_table_6.html"><i class="fa fa-check"></i><b>17</b> Supp table 6</a>
<ul>
<li class="chapter" data-level="17.1" data-path="17-Supp_table_6.html"><a href="17-Supp_table_6.html#libraries-13"><i class="fa fa-check"></i><b>17.1</b> libraries</a>
<ul>
<li class="chapter" data-level="17.1.1" data-path="17-Supp_table_6.html"><a href="17-Supp_table_6.html#statisitical-tests"><i class="fa fa-check"></i><b>17.1.1</b> Statisitical tests</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="18" data-path="18-Supp_table_7.html"><a href="18-Supp_table_7.html"><i class="fa fa-check"></i><b>18</b> Supp table 7</a></li>
<li class="chapter" data-level="19" data-path="19-Supp_table_8.html"><a href="19-Supp_table_8.html"><i class="fa fa-check"></i><b>19</b> Supp table 8</a>
<ul>
<li class="chapter" data-level="19.1" data-path="19-Supp_table_8.html"><a href="19-Supp_table_8.html#libraries-14"><i class="fa fa-check"></i><b>19.1</b> Libraries</a></li>
<li class="chapter" data-level="19.2" data-path="19-Supp_table_8.html"><a href="19-Supp_table_8.html#preprocess-tables-1"><i class="fa fa-check"></i><b>19.2</b> Preprocess tables</a></li>
<li class="chapter" data-level="19.3" data-path="19-Supp_table_8.html"><a href="19-Supp_table_8.html#no-buffer"><i class="fa fa-check"></i><b>19.3</b> No buffer</a>
<ul>
<li class="chapter" data-level="19.3.1" data-path="19-Supp_table_8.html"><a href="19-Supp_table_8.html#correlation-1"><i class="fa fa-check"></i><b>19.3.1</b> Correlation</a></li>
</ul></li>
<li class="chapter" data-level="19.4" data-path="19-Supp_table_8.html"><a href="19-Supp_table_8.html#rnalater"><i class="fa fa-check"></i><b>19.4</b> RNAlater</a>
<ul>
<li class="chapter" data-level="19.4.1" data-path="19-Supp_table_8.html"><a href="19-Supp_table_8.html#correlation-2"><i class="fa fa-check"></i><b>19.4.1</b> Correlation</a></li>
</ul></li>
<li class="chapter" data-level="19.5" data-path="19-Supp_table_8.html"><a href="19-Supp_table_8.html#ethanol"><i class="fa fa-check"></i><b>19.5</b> Ethanol</a>
<ul>
<li class="chapter" data-level="19.5.1" data-path="19-Supp_table_8.html"><a href="19-Supp_table_8.html#correlation-3"><i class="fa fa-check"></i><b>19.5.1</b> Correlation</a></li>
</ul></li>
<li class="chapter" data-level="19.6" data-path="19-Supp_table_8.html"><a href="19-Supp_table_8.html#psp"><i class="fa fa-check"></i><b>19.6</b> PSP</a>
<ul>
<li class="chapter" data-level="19.6.1" data-path="19-Supp_table_8.html"><a href="19-Supp_table_8.html#correlation-4"><i class="fa fa-check"></i><b>19.6.1</b> Correlation</a></li>
</ul></li>
<li class="chapter" data-level="19.7" data-path="19-Supp_table_8.html"><a href="19-Supp_table_8.html#compare-results"><i class="fa fa-check"></i><b>19.7</b> Compare results</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Optimised human stool sample collection for multi-omic microbiota analysis R code</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="supp-figure-3" class="section level1 hasAnchor" number="9">
<h1><span class="header-section-number">Chapter 9</span> Supp figure 3<a href="09-Supp_fig_3.html#supp-figure-3" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Violin plots testing the effect of metadata categories on the 16S beta diversity (Weighted unifrac) paired distances between samples. (A) Displays distances within effect groups (Bufferused, Participant number, Storagedays, and Storagetemp). Paired distances between samples which only differed by the specified effect on the x-axis are included. (B) Displays paired distances between the specified buffer comparisons. Only paired distances between samples with identical Participant number, Storagedays, and Storagetemp are included.</p>
<p><img src="figures/Supp_fig_3.png" width="100%" style="display: block; margin: auto;" /></p>
<div id="libraries-6" class="section level2 hasAnchor" number="9.1">
<h2><span class="header-section-number">9.1</span> Libraries<a href="09-Supp_fig_3.html#libraries-6" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="09-Supp_fig_3.html#cb34-1" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;phyloseq&quot;</span>)</span>
<span id="cb34-2"><a href="09-Supp_fig_3.html#cb34-2" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;microbiome&quot;</span>)</span>
<span id="cb34-3"><a href="09-Supp_fig_3.html#cb34-3" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;ggplot2&quot;</span>)</span>
<span id="cb34-4"><a href="09-Supp_fig_3.html#cb34-4" tabindex="-1"></a><span class="co">#library(&quot;plotly&quot;)</span></span>
<span id="cb34-5"><a href="09-Supp_fig_3.html#cb34-5" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;tidyverse&quot;</span>)</span>
<span id="cb34-6"><a href="09-Supp_fig_3.html#cb34-6" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;ggforce&quot;</span>)</span>
<span id="cb34-7"><a href="09-Supp_fig_3.html#cb34-7" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;ggh4x&quot;</span>)</span>
<span id="cb34-8"><a href="09-Supp_fig_3.html#cb34-8" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;patchwork&quot;</span>)</span>
<span id="cb34-9"><a href="09-Supp_fig_3.html#cb34-9" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;rbiom&quot;</span>)</span></code></pre></div>
</div>
<div id="s-composition" class="section level2 hasAnchor" number="9.2">
<h2><span class="header-section-number">9.2</span> 16S composition<a href="09-Supp_fig_3.html#s-composition" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Carrying out inter distance divergence</p>
<p>We want one boxplot showing difference caused by different factors</p>
<ul>
<li>Temp</li>
<li>Buffer</li>
<li>Participant</li>
<li>Storage days</li>
</ul>
<p>For Temp we get all identical paired samples that only differ by temp to get those paired distances.
We then produce a boxplot from this.
We can then compare this bxoplot to the buffer one, participant one, and storage days one in one plot with boxes.</p>
<div id="table-of-all-paired-distances" class="section level3 hasAnchor" number="9.2.1">
<h3><span class="header-section-number">9.2.1</span> Table of all paired distances<a href="09-Supp_fig_3.html#table-of-all-paired-distances" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="09-Supp_fig_3.html#cb35-1" tabindex="-1"></a><span class="co">#Load rarefied data created for figure 2A</span></span>
<span id="cb35-2"><a href="09-Supp_fig_3.html#cb35-2" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&quot;./data/preproces_physeq_even_depth30k&quot;</span>)</span>
<span id="cb35-3"><a href="09-Supp_fig_3.html#cb35-3" tabindex="-1"></a><span class="co">#Calculate weighted Unifrac values</span></span>
<span id="cb35-4"><a href="09-Supp_fig_3.html#cb35-4" tabindex="-1"></a>wunifrac_df <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(rbiom<span class="sc">::</span><span class="fu">unifrac</span>(<span class="at">biom =</span> microbiome<span class="sc">::</span><span class="fu">abundances</span>(physeq),</span>
<span id="cb35-5"><a href="09-Supp_fig_3.html#cb35-5" tabindex="-1"></a>                                        <span class="at">weighted=</span><span class="cn">TRUE</span>, <span class="at">tree =</span> phyloseq<span class="sc">::</span><span class="fu">phy_tree</span>(physeq)))</span>
<span id="cb35-6"><a href="09-Supp_fig_3.html#cb35-6" tabindex="-1"></a><span class="co">#Convert doubled distance values and same comparisons to NAs</span></span>
<span id="cb35-7"><a href="09-Supp_fig_3.html#cb35-7" tabindex="-1"></a><span class="co">#Loop through columns starting at the 2nd</span></span>
<span id="cb35-8"><a href="09-Supp_fig_3.html#cb35-8" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb35-9"><a href="09-Supp_fig_3.html#cb35-9" tabindex="-1"></a><span class="cf">for</span> (r <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(wunifrac_df)) {</span>
<span id="cb35-10"><a href="09-Supp_fig_3.html#cb35-10" tabindex="-1"></a>  wunifrac_df[r,r<span class="sc">:</span><span class="fu">ncol</span>(wunifrac_df)] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb35-11"><a href="09-Supp_fig_3.html#cb35-11" tabindex="-1"></a>}</span>
<span id="cb35-12"><a href="09-Supp_fig_3.html#cb35-12" tabindex="-1"></a><span class="co">#Get a metdata dataframe with:</span></span>
<span id="cb35-13"><a href="09-Supp_fig_3.html#cb35-13" tabindex="-1"></a><span class="co"># Sample name, Temp, Buffer, Paricipant, and storage days</span></span>
<span id="cb35-14"><a href="09-Supp_fig_3.html#cb35-14" tabindex="-1"></a>metadf <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">sample_data</span>(physeq))</span>
<span id="cb35-15"><a href="09-Supp_fig_3.html#cb35-15" tabindex="-1"></a>columns_of_interest <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Sample_name&quot;</span>, <span class="st">&quot;Patientnumber&quot;</span>,<span class="st">&quot;Bufferused&quot;</span>, <span class="st">&quot;Storagetemp&quot;</span>,<span class="st">&quot;DaysstoredpriortoDNAextraction&quot;</span>)</span>
<span id="cb35-16"><a href="09-Supp_fig_3.html#cb35-16" tabindex="-1"></a>metadf <span class="ot">&lt;-</span> metadf[,columns_of_interest]</span>
<span id="cb35-17"><a href="09-Supp_fig_3.html#cb35-17" tabindex="-1"></a><span class="co">#Change some of the metadata values</span></span>
<span id="cb35-18"><a href="09-Supp_fig_3.html#cb35-18" tabindex="-1"></a>metadf<span class="sc">$</span>Storagetemp <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="at">x =</span> metadf<span class="sc">$</span>Storagetemp, <span class="at">pattern =</span> <span class="st">&quot;-80&quot;</span> , <span class="at">replacement =</span> <span class="st">&quot;Baseline&quot;</span>)</span>
<span id="cb35-19"><a href="09-Supp_fig_3.html#cb35-19" tabindex="-1"></a>metadf<span class="sc">$</span>Storagetemp <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="at">x =</span> metadf<span class="sc">$</span>Storagetemp, <span class="at">pattern =</span> <span class="st">&quot;4&quot;</span> , <span class="at">replacement =</span> <span class="st">&quot;Fridge&quot;</span>)</span>
<span id="cb35-20"><a href="09-Supp_fig_3.html#cb35-20" tabindex="-1"></a>metadf<span class="sc">$</span>Storagetemp <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="at">x =</span> metadf<span class="sc">$</span>Storagetemp, <span class="at">pattern =</span> <span class="st">&quot;20&quot;</span> , <span class="at">replacement =</span> <span class="st">&quot;RT&quot;</span>)</span>
<span id="cb35-21"><a href="09-Supp_fig_3.html#cb35-21" tabindex="-1"></a>metadf<span class="sc">$</span>DaysstoredpriortoDNAextraction <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="at">x =</span> metadf<span class="sc">$</span>DaysstoredpriortoDNAextraction, <span class="at">pattern =</span> <span class="st">&quot;1&quot;</span> , <span class="at">replacement =</span> <span class="st">&quot;1D&quot;</span>)</span>
<span id="cb35-22"><a href="09-Supp_fig_3.html#cb35-22" tabindex="-1"></a>metadf<span class="sc">$</span>DaysstoredpriortoDNAextraction <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="at">x =</span> metadf<span class="sc">$</span>DaysstoredpriortoDNAextraction, <span class="at">pattern =</span> <span class="st">&quot;3&quot;</span> , <span class="at">replacement =</span> <span class="st">&quot;3D&quot;</span>)</span>
<span id="cb35-23"><a href="09-Supp_fig_3.html#cb35-23" tabindex="-1"></a>metadf[metadf<span class="sc">$</span>Storagetemp <span class="sc">==</span> <span class="st">&quot;Baseline&quot;</span>,<span class="st">&quot;DaysstoredpriortoDNAextraction&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Baseline&quot;</span></span>
<span id="cb35-24"><a href="09-Supp_fig_3.html#cb35-24" tabindex="-1"></a></span>
<span id="cb35-25"><a href="09-Supp_fig_3.html#cb35-25" tabindex="-1"></a><span class="co">#Combine metadata and distance matrix</span></span>
<span id="cb35-26"><a href="09-Supp_fig_3.html#cb35-26" tabindex="-1"></a><span class="co">#Ensure the row order is the same</span></span>
<span id="cb35-27"><a href="09-Supp_fig_3.html#cb35-27" tabindex="-1"></a><span class="co">#identical(row.names(metadf), row.names(wunifrac_df)) </span></span>
<span id="cb35-28"><a href="09-Supp_fig_3.html#cb35-28" tabindex="-1"></a><span class="co">#rbind</span></span>
<span id="cb35-29"><a href="09-Supp_fig_3.html#cb35-29" tabindex="-1"></a>wunifrac_metadata_df <span class="ot">&lt;-</span> <span class="fu">cbind</span>(metadf, wunifrac_df)</span>
<span id="cb35-30"><a href="09-Supp_fig_3.html#cb35-30" tabindex="-1"></a><span class="co">#Convert to long</span></span>
<span id="cb35-31"><a href="09-Supp_fig_3.html#cb35-31" tabindex="-1"></a>wunifrac_long_df <span class="ot">&lt;-</span> tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(<span class="at">data =</span> wunifrac_metadata_df,</span>
<span id="cb35-32"><a href="09-Supp_fig_3.html#cb35-32" tabindex="-1"></a>                                        <span class="co">#longify the distance values by using the</span></span>
<span id="cb35-33"><a href="09-Supp_fig_3.html#cb35-33" tabindex="-1"></a>                                        <span class="co">#col names of the distance df</span></span>
<span id="cb35-34"><a href="09-Supp_fig_3.html#cb35-34" tabindex="-1"></a>                                        <span class="at">cols =</span> <span class="fu">colnames</span>(wunifrac_df),</span>
<span id="cb35-35"><a href="09-Supp_fig_3.html#cb35-35" tabindex="-1"></a>                                        <span class="at">names_to =</span> <span class="st">&quot;Sample_name_comp&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;dist&quot;</span>)</span>
<span id="cb35-36"><a href="09-Supp_fig_3.html#cb35-36" tabindex="-1"></a><span class="co">#Change sample names of comp_samples names to remove _.*</span></span>
<span id="cb35-37"><a href="09-Supp_fig_3.html#cb35-37" tabindex="-1"></a>wunifrac_long_df<span class="sc">$</span>Sample_name_comp <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="at">x =</span> wunifrac_long_df<span class="sc">$</span>Sample_name_comp, </span>
<span id="cb35-38"><a href="09-Supp_fig_3.html#cb35-38" tabindex="-1"></a>                                           <span class="at">pattern =</span> <span class="st">&quot;_.*&quot;</span>, <span class="at">replacement =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb35-39"><a href="09-Supp_fig_3.html#cb35-39" tabindex="-1"></a><span class="co">#Remove rows where dist is NA</span></span>
<span id="cb35-40"><a href="09-Supp_fig_3.html#cb35-40" tabindex="-1"></a><span class="co">#Identical sample comparisons and duplicated sample comparisons</span></span>
<span id="cb35-41"><a href="09-Supp_fig_3.html#cb35-41" tabindex="-1"></a>wunifrac_long_df <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(wunifrac_long_df)</span>
<span id="cb35-42"><a href="09-Supp_fig_3.html#cb35-42" tabindex="-1"></a><span class="co">#Remove rows where the samples are identical</span></span>
<span id="cb35-43"><a href="09-Supp_fig_3.html#cb35-43" tabindex="-1"></a>wunifrac_long_df <span class="ot">&lt;-</span> wunifrac_long_df[wunifrac_long_df<span class="sc">$</span>Sample_name <span class="sc">!=</span> wunifrac_long_df<span class="sc">$</span>Sample_name_comp,]</span>
<span id="cb35-44"><a href="09-Supp_fig_3.html#cb35-44" tabindex="-1"></a><span class="co">#Add metadata for comparison sample</span></span>
<span id="cb35-45"><a href="09-Supp_fig_3.html#cb35-45" tabindex="-1"></a>wunifrac_long_df<span class="sc">$</span>Patientnumber_comp <span class="ot">&lt;-</span></span>
<span id="cb35-46"><a href="09-Supp_fig_3.html#cb35-46" tabindex="-1"></a>  <span class="fu">as.vector</span>(<span class="fu">unlist</span>(metadf[wunifrac_long_df<span class="sc">$</span>Sample_name_comp,<span class="st">&quot;Patientnumber&quot;</span>]))</span>
<span id="cb35-47"><a href="09-Supp_fig_3.html#cb35-47" tabindex="-1"></a>wunifrac_long_df<span class="sc">$</span>Bufferused_comp <span class="ot">&lt;-</span></span>
<span id="cb35-48"><a href="09-Supp_fig_3.html#cb35-48" tabindex="-1"></a>  <span class="fu">as.vector</span>(<span class="fu">unlist</span>(metadf[wunifrac_long_df<span class="sc">$</span>Sample_name_comp,<span class="st">&quot;Bufferused&quot;</span>]))</span>
<span id="cb35-49"><a href="09-Supp_fig_3.html#cb35-49" tabindex="-1"></a>wunifrac_long_df<span class="sc">$</span>Storagetemp_comp <span class="ot">&lt;-</span></span>
<span id="cb35-50"><a href="09-Supp_fig_3.html#cb35-50" tabindex="-1"></a>  <span class="fu">as.vector</span>(<span class="fu">unlist</span>(metadf[wunifrac_long_df<span class="sc">$</span>Sample_name_comp,<span class="st">&quot;Storagetemp&quot;</span>]))</span>
<span id="cb35-51"><a href="09-Supp_fig_3.html#cb35-51" tabindex="-1"></a>wunifrac_long_df<span class="sc">$</span>DaysstoredpriortoDNAextraction_comp <span class="ot">&lt;-</span></span>
<span id="cb35-52"><a href="09-Supp_fig_3.html#cb35-52" tabindex="-1"></a>  <span class="fu">as.vector</span>(<span class="fu">unlist</span>(metadf[wunifrac_long_df<span class="sc">$</span>Sample_name_comp,<span class="st">&quot;DaysstoredpriortoDNAextraction&quot;</span>]))</span>
<span id="cb35-53"><a href="09-Supp_fig_3.html#cb35-53" tabindex="-1"></a><span class="co">#Move dist to end row</span></span>
<span id="cb35-54"><a href="09-Supp_fig_3.html#cb35-54" tabindex="-1"></a>wunifrac_long_df<span class="sc">$</span>wunifrac <span class="ot">&lt;-</span> wunifrac_long_df<span class="sc">$</span>dist</span>
<span id="cb35-55"><a href="09-Supp_fig_3.html#cb35-55" tabindex="-1"></a>wunifrac_long_df <span class="ot">&lt;-</span> <span class="fu">subset</span>(wunifrac_long_df, <span class="at">select =</span> <span class="sc">-</span>dist)</span>
<span id="cb35-56"><a href="09-Supp_fig_3.html#cb35-56" tabindex="-1"></a><span class="co">#Remove unneeded objects</span></span>
<span id="cb35-57"><a href="09-Supp_fig_3.html#cb35-57" tabindex="-1"></a><span class="fu">rm</span>(physeq, wunifrac_metadata_df)</span></code></pre></div>
</div>
<div id="extract-the-paired-distances" class="section level3 hasAnchor" number="9.2.2">
<h3><span class="header-section-number">9.2.2</span> Extract the paired distances<a href="09-Supp_fig_3.html#extract-the-paired-distances" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We will end up with a data frame with the following columns</p>
<ul>
<li>Distance (wunifrac)</li>
<li>Effect (temp, buffer, etc.)</li>
<li>Comparison (e.g. Baseline_RT)</li>
<li>Sample pair (A1_B1)</li>
</ul>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="09-Supp_fig_3.html#cb36-1" tabindex="-1"></a><span class="co">#Create an empty dataframe first</span></span>
<span id="cb36-2"><a href="09-Supp_fig_3.html#cb36-2" tabindex="-1"></a>dist_df_long <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">matrix</span>(<span class="at">data =</span> <span class="cn">NA</span>, <span class="at">ncol =</span> <span class="dv">4</span>, <span class="at">nrow =</span> <span class="dv">0</span>))</span>
<span id="cb36-3"><a href="09-Supp_fig_3.html#cb36-3" tabindex="-1"></a><span class="fu">colnames</span>(dist_df_long) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;wunifrac&quot;</span>, <span class="st">&quot;effect&quot;</span>, <span class="st">&quot;comparison&quot;</span>,<span class="st">&quot;sample_pair&quot;</span>)</span>
<span id="cb36-4"><a href="09-Supp_fig_3.html#cb36-4" tabindex="-1"></a></span>
<span id="cb36-5"><a href="09-Supp_fig_3.html#cb36-5" tabindex="-1"></a><span class="co">#First for participant</span></span>
<span id="cb36-6"><a href="09-Supp_fig_3.html#cb36-6" tabindex="-1"></a>participant_df <span class="ot">&lt;-</span> wunifrac_long_df</span>
<span id="cb36-7"><a href="09-Supp_fig_3.html#cb36-7" tabindex="-1"></a><span class="co">#create new columns of combined buffer, temp, and days for ease</span></span>
<span id="cb36-8"><a href="09-Supp_fig_3.html#cb36-8" tabindex="-1"></a>participant_df<span class="sc">$</span>buffer_temp_days <span class="ot">&lt;-</span> <span class="fu">paste0</span>(participant_df<span class="sc">$</span>Bufferused, <span class="st">&quot;_&quot;</span>,</span>
<span id="cb36-9"><a href="09-Supp_fig_3.html#cb36-9" tabindex="-1"></a>                                         participant_df<span class="sc">$</span>Storagetemp, <span class="st">&quot;_&quot;</span>,</span>
<span id="cb36-10"><a href="09-Supp_fig_3.html#cb36-10" tabindex="-1"></a>                                         participant_df<span class="sc">$</span>DaysstoredpriortoDNAextraction)</span>
<span id="cb36-11"><a href="09-Supp_fig_3.html#cb36-11" tabindex="-1"></a>participant_df<span class="sc">$</span>buffer_temp_days_comp <span class="ot">&lt;-</span> <span class="fu">paste0</span>(participant_df<span class="sc">$</span>Bufferused_comp, <span class="st">&quot;_&quot;</span>,</span>
<span id="cb36-12"><a href="09-Supp_fig_3.html#cb36-12" tabindex="-1"></a>                                         participant_df<span class="sc">$</span>Storagetemp_comp, <span class="st">&quot;_&quot;</span>,</span>
<span id="cb36-13"><a href="09-Supp_fig_3.html#cb36-13" tabindex="-1"></a>                                         participant_df<span class="sc">$</span>DaysstoredpriortoDNAextraction_comp)</span>
<span id="cb36-14"><a href="09-Supp_fig_3.html#cb36-14" tabindex="-1"></a><span class="co">#Keep only rows where these 2 created rows are identical</span></span>
<span id="cb36-15"><a href="09-Supp_fig_3.html#cb36-15" tabindex="-1"></a>participant_df <span class="ot">&lt;-</span> participant_df[</span>
<span id="cb36-16"><a href="09-Supp_fig_3.html#cb36-16" tabindex="-1"></a>  participant_df<span class="sc">$</span>buffer_temp_days <span class="sc">==</span> participant_df<span class="sc">$</span>buffer_temp_days_comp,]</span>
<span id="cb36-17"><a href="09-Supp_fig_3.html#cb36-17" tabindex="-1"></a><span class="co">#Add effects column</span></span>
<span id="cb36-18"><a href="09-Supp_fig_3.html#cb36-18" tabindex="-1"></a>participant_df<span class="sc">$</span>effect <span class="ot">&lt;-</span> <span class="st">&quot;Participant number&quot;</span></span>
<span id="cb36-19"><a href="09-Supp_fig_3.html#cb36-19" tabindex="-1"></a><span class="co">#Add comparison column</span></span>
<span id="cb36-20"><a href="09-Supp_fig_3.html#cb36-20" tabindex="-1"></a>participant_df<span class="sc">$</span>comparison <span class="ot">&lt;-</span> <span class="fu">paste0</span>(participant_df<span class="sc">$</span>Patientnumber, <span class="st">&quot;_&quot;</span>,</span>
<span id="cb36-21"><a href="09-Supp_fig_3.html#cb36-21" tabindex="-1"></a>                                   participant_df<span class="sc">$</span>Patientnumber_comp)</span>
<span id="cb36-22"><a href="09-Supp_fig_3.html#cb36-22" tabindex="-1"></a><span class="co">#Add pairs column</span></span>
<span id="cb36-23"><a href="09-Supp_fig_3.html#cb36-23" tabindex="-1"></a>participant_df<span class="sc">$</span>sample_pair <span class="ot">&lt;-</span> <span class="fu">paste0</span>(participant_df<span class="sc">$</span>Sample_name, <span class="st">&quot;_&quot;</span>, participant_df<span class="sc">$</span>Sample_name_comp)</span>
<span id="cb36-24"><a href="09-Supp_fig_3.html#cb36-24" tabindex="-1"></a><span class="co">#Create df  to add to main df</span></span>
<span id="cb36-25"><a href="09-Supp_fig_3.html#cb36-25" tabindex="-1"></a>tmp_dist_df <span class="ot">&lt;-</span> participant_df[,<span class="fu">c</span>(<span class="st">&quot;wunifrac&quot;</span>, <span class="st">&quot;effect&quot;</span>, <span class="st">&quot;comparison&quot;</span>, <span class="st">&quot;sample_pair&quot;</span>)]</span>
<span id="cb36-26"><a href="09-Supp_fig_3.html#cb36-26" tabindex="-1"></a><span class="co">#Add to dist data frame</span></span>
<span id="cb36-27"><a href="09-Supp_fig_3.html#cb36-27" tabindex="-1"></a>dist_df_long <span class="ot">&lt;-</span> <span class="fu">rbind</span>(dist_df_long, tmp_dist_df)</span>
<span id="cb36-28"><a href="09-Supp_fig_3.html#cb36-28" tabindex="-1"></a></span>
<span id="cb36-29"><a href="09-Supp_fig_3.html#cb36-29" tabindex="-1"></a><span class="co">#Second is Buffer</span></span>
<span id="cb36-30"><a href="09-Supp_fig_3.html#cb36-30" tabindex="-1"></a>buffer_df <span class="ot">&lt;-</span> wunifrac_long_df</span>
<span id="cb36-31"><a href="09-Supp_fig_3.html#cb36-31" tabindex="-1"></a><span class="co">#create new columns of combined participant, temp, and days for ease</span></span>
<span id="cb36-32"><a href="09-Supp_fig_3.html#cb36-32" tabindex="-1"></a>buffer_df<span class="sc">$</span>participant_temp_days <span class="ot">&lt;-</span> <span class="fu">paste0</span>(buffer_df<span class="sc">$</span>Patientnumber, <span class="st">&quot;_&quot;</span>,</span>
<span id="cb36-33"><a href="09-Supp_fig_3.html#cb36-33" tabindex="-1"></a>                                         buffer_df<span class="sc">$</span>Storagetemp, <span class="st">&quot;_&quot;</span>,</span>
<span id="cb36-34"><a href="09-Supp_fig_3.html#cb36-34" tabindex="-1"></a>                                         buffer_df<span class="sc">$</span>DaysstoredpriortoDNAextraction)</span>
<span id="cb36-35"><a href="09-Supp_fig_3.html#cb36-35" tabindex="-1"></a>buffer_df<span class="sc">$</span>participant_temp_days_comp <span class="ot">&lt;-</span> <span class="fu">paste0</span>(buffer_df<span class="sc">$</span>Patientnumber_comp, <span class="st">&quot;_&quot;</span>,</span>
<span id="cb36-36"><a href="09-Supp_fig_3.html#cb36-36" tabindex="-1"></a>                                         buffer_df<span class="sc">$</span>Storagetemp_comp, <span class="st">&quot;_&quot;</span>,</span>
<span id="cb36-37"><a href="09-Supp_fig_3.html#cb36-37" tabindex="-1"></a>                                         buffer_df<span class="sc">$</span>DaysstoredpriortoDNAextraction_comp)</span>
<span id="cb36-38"><a href="09-Supp_fig_3.html#cb36-38" tabindex="-1"></a><span class="co">#Keep only rows where these 2 created rows are identical</span></span>
<span id="cb36-39"><a href="09-Supp_fig_3.html#cb36-39" tabindex="-1"></a>buffer_df <span class="ot">&lt;-</span> buffer_df[</span>
<span id="cb36-40"><a href="09-Supp_fig_3.html#cb36-40" tabindex="-1"></a>  buffer_df<span class="sc">$</span>participant_temp_days <span class="sc">==</span> buffer_df<span class="sc">$</span>participant_temp_days_comp,]</span>
<span id="cb36-41"><a href="09-Supp_fig_3.html#cb36-41" tabindex="-1"></a><span class="co">#Add effects column</span></span>
<span id="cb36-42"><a href="09-Supp_fig_3.html#cb36-42" tabindex="-1"></a>buffer_df<span class="sc">$</span>effect <span class="ot">&lt;-</span> <span class="st">&quot;Bufferused&quot;</span></span>
<span id="cb36-43"><a href="09-Supp_fig_3.html#cb36-43" tabindex="-1"></a><span class="co">#Add comparison column</span></span>
<span id="cb36-44"><a href="09-Supp_fig_3.html#cb36-44" tabindex="-1"></a>buffer_df<span class="sc">$</span>comparison <span class="ot">&lt;-</span> <span class="fu">paste0</span>(buffer_df<span class="sc">$</span>Bufferused, <span class="st">&quot;_&quot;</span>,</span>
<span id="cb36-45"><a href="09-Supp_fig_3.html#cb36-45" tabindex="-1"></a>                                   buffer_df<span class="sc">$</span>Bufferused_comp)</span>
<span id="cb36-46"><a href="09-Supp_fig_3.html#cb36-46" tabindex="-1"></a><span class="co">#Add pairs column</span></span>
<span id="cb36-47"><a href="09-Supp_fig_3.html#cb36-47" tabindex="-1"></a>buffer_df<span class="sc">$</span>sample_pair <span class="ot">&lt;-</span> <span class="fu">paste0</span>(buffer_df<span class="sc">$</span>Sample_name, <span class="st">&quot;_&quot;</span>, buffer_df<span class="sc">$</span>Sample_name_comp)</span>
<span id="cb36-48"><a href="09-Supp_fig_3.html#cb36-48" tabindex="-1"></a><span class="co">#Create df  to add to main df</span></span>
<span id="cb36-49"><a href="09-Supp_fig_3.html#cb36-49" tabindex="-1"></a>tmp_dist_df <span class="ot">&lt;-</span> buffer_df[,<span class="fu">c</span>(<span class="st">&quot;wunifrac&quot;</span>, <span class="st">&quot;effect&quot;</span>, <span class="st">&quot;comparison&quot;</span>, <span class="st">&quot;sample_pair&quot;</span>)]</span>
<span id="cb36-50"><a href="09-Supp_fig_3.html#cb36-50" tabindex="-1"></a><span class="co">#Add to dist data frame</span></span>
<span id="cb36-51"><a href="09-Supp_fig_3.html#cb36-51" tabindex="-1"></a>dist_df_long <span class="ot">&lt;-</span> <span class="fu">rbind</span>(dist_df_long, tmp_dist_df)</span>
<span id="cb36-52"><a href="09-Supp_fig_3.html#cb36-52" tabindex="-1"></a></span>
<span id="cb36-53"><a href="09-Supp_fig_3.html#cb36-53" tabindex="-1"></a><span class="co">#Third is Storagetemp</span></span>
<span id="cb36-54"><a href="09-Supp_fig_3.html#cb36-54" tabindex="-1"></a>temp_df <span class="ot">&lt;-</span> wunifrac_long_df</span>
<span id="cb36-55"><a href="09-Supp_fig_3.html#cb36-55" tabindex="-1"></a><span class="co">#create new columns of combined participant, buffer, and days for ease</span></span>
<span id="cb36-56"><a href="09-Supp_fig_3.html#cb36-56" tabindex="-1"></a>temp_df<span class="sc">$</span>participant_buffer_days <span class="ot">&lt;-</span> <span class="fu">paste0</span>(temp_df<span class="sc">$</span>Patientnumber, <span class="st">&quot;_&quot;</span>,</span>
<span id="cb36-57"><a href="09-Supp_fig_3.html#cb36-57" tabindex="-1"></a>                                         temp_df<span class="sc">$</span>Bufferused, <span class="st">&quot;_&quot;</span>,</span>
<span id="cb36-58"><a href="09-Supp_fig_3.html#cb36-58" tabindex="-1"></a>                                         temp_df<span class="sc">$</span>DaysstoredpriortoDNAextraction)</span>
<span id="cb36-59"><a href="09-Supp_fig_3.html#cb36-59" tabindex="-1"></a>temp_df<span class="sc">$</span>participant_buffer_days_comp <span class="ot">&lt;-</span> <span class="fu">paste0</span>(temp_df<span class="sc">$</span>Patientnumber_comp, <span class="st">&quot;_&quot;</span>,</span>
<span id="cb36-60"><a href="09-Supp_fig_3.html#cb36-60" tabindex="-1"></a>                                         temp_df<span class="sc">$</span>Bufferused_comp, <span class="st">&quot;_&quot;</span>,</span>
<span id="cb36-61"><a href="09-Supp_fig_3.html#cb36-61" tabindex="-1"></a>                                         temp_df<span class="sc">$</span>DaysstoredpriortoDNAextraction_comp)</span>
<span id="cb36-62"><a href="09-Supp_fig_3.html#cb36-62" tabindex="-1"></a><span class="co">#Keep only rows where these 2 created rows are identical</span></span>
<span id="cb36-63"><a href="09-Supp_fig_3.html#cb36-63" tabindex="-1"></a>temp_df <span class="ot">&lt;-</span> temp_df[</span>
<span id="cb36-64"><a href="09-Supp_fig_3.html#cb36-64" tabindex="-1"></a>  temp_df<span class="sc">$</span>participant_buffer_days <span class="sc">==</span> temp_df<span class="sc">$</span>participant_buffer_days_comp,]</span>
<span id="cb36-65"><a href="09-Supp_fig_3.html#cb36-65" tabindex="-1"></a><span class="co">#Add effects column</span></span>
<span id="cb36-66"><a href="09-Supp_fig_3.html#cb36-66" tabindex="-1"></a>temp_df<span class="sc">$</span>effect <span class="ot">&lt;-</span> <span class="st">&quot;Storagetemp&quot;</span></span>
<span id="cb36-67"><a href="09-Supp_fig_3.html#cb36-67" tabindex="-1"></a><span class="co">#Add comparison column</span></span>
<span id="cb36-68"><a href="09-Supp_fig_3.html#cb36-68" tabindex="-1"></a>temp_df<span class="sc">$</span>comparison <span class="ot">&lt;-</span> <span class="fu">paste0</span>(temp_df<span class="sc">$</span>Storagetemp, <span class="st">&quot;_&quot;</span>,</span>
<span id="cb36-69"><a href="09-Supp_fig_3.html#cb36-69" tabindex="-1"></a>                                   temp_df<span class="sc">$</span>Storagetemp_comp)</span>
<span id="cb36-70"><a href="09-Supp_fig_3.html#cb36-70" tabindex="-1"></a><span class="co">#Add pairs column</span></span>
<span id="cb36-71"><a href="09-Supp_fig_3.html#cb36-71" tabindex="-1"></a>temp_df<span class="sc">$</span>sample_pair <span class="ot">&lt;-</span> <span class="fu">paste0</span>(temp_df<span class="sc">$</span>Sample_name, <span class="st">&quot;_&quot;</span>, temp_df<span class="sc">$</span>Sample_name_comp)</span>
<span id="cb36-72"><a href="09-Supp_fig_3.html#cb36-72" tabindex="-1"></a><span class="co">#Create df  to add to main df</span></span>
<span id="cb36-73"><a href="09-Supp_fig_3.html#cb36-73" tabindex="-1"></a>tmp_dist_df <span class="ot">&lt;-</span> temp_df[,<span class="fu">c</span>(<span class="st">&quot;wunifrac&quot;</span>, <span class="st">&quot;effect&quot;</span>, <span class="st">&quot;comparison&quot;</span>, <span class="st">&quot;sample_pair&quot;</span>)]</span>
<span id="cb36-74"><a href="09-Supp_fig_3.html#cb36-74" tabindex="-1"></a><span class="co">#Add to dist data frame</span></span>
<span id="cb36-75"><a href="09-Supp_fig_3.html#cb36-75" tabindex="-1"></a>dist_df_long <span class="ot">&lt;-</span> <span class="fu">rbind</span>(dist_df_long, tmp_dist_df)</span>
<span id="cb36-76"><a href="09-Supp_fig_3.html#cb36-76" tabindex="-1"></a></span>
<span id="cb36-77"><a href="09-Supp_fig_3.html#cb36-77" tabindex="-1"></a><span class="co">#Fourth is Storagedays</span></span>
<span id="cb36-78"><a href="09-Supp_fig_3.html#cb36-78" tabindex="-1"></a>days_df <span class="ot">&lt;-</span> wunifrac_long_df</span>
<span id="cb36-79"><a href="09-Supp_fig_3.html#cb36-79" tabindex="-1"></a><span class="co">#create new columns of combined participant, buffer, and temp for ease</span></span>
<span id="cb36-80"><a href="09-Supp_fig_3.html#cb36-80" tabindex="-1"></a>days_df<span class="sc">$</span>participant_buffer_temp <span class="ot">&lt;-</span> <span class="fu">paste0</span>(days_df<span class="sc">$</span>Patientnumber, <span class="st">&quot;_&quot;</span>,</span>
<span id="cb36-81"><a href="09-Supp_fig_3.html#cb36-81" tabindex="-1"></a>                                         days_df<span class="sc">$</span>Bufferused, <span class="st">&quot;_&quot;</span>,</span>
<span id="cb36-82"><a href="09-Supp_fig_3.html#cb36-82" tabindex="-1"></a>                                         days_df<span class="sc">$</span>Storagetemp)</span>
<span id="cb36-83"><a href="09-Supp_fig_3.html#cb36-83" tabindex="-1"></a>days_df<span class="sc">$</span>participant_buffer_days_temp <span class="ot">&lt;-</span> <span class="fu">paste0</span>(days_df<span class="sc">$</span>Patientnumber_comp, <span class="st">&quot;_&quot;</span>,</span>
<span id="cb36-84"><a href="09-Supp_fig_3.html#cb36-84" tabindex="-1"></a>                                         days_df<span class="sc">$</span>Bufferused_comp, <span class="st">&quot;_&quot;</span>,</span>
<span id="cb36-85"><a href="09-Supp_fig_3.html#cb36-85" tabindex="-1"></a>                                         days_df<span class="sc">$</span>Storagetemp_comp)</span>
<span id="cb36-86"><a href="09-Supp_fig_3.html#cb36-86" tabindex="-1"></a><span class="co">#Keep only rows where these 2 created rows are identical</span></span>
<span id="cb36-87"><a href="09-Supp_fig_3.html#cb36-87" tabindex="-1"></a>days_df <span class="ot">&lt;-</span> days_df[</span>
<span id="cb36-88"><a href="09-Supp_fig_3.html#cb36-88" tabindex="-1"></a>  days_df<span class="sc">$</span>participant_buffer_temp <span class="sc">==</span> days_df<span class="sc">$</span>participant_buffer_days_temp,]</span>
<span id="cb36-89"><a href="09-Supp_fig_3.html#cb36-89" tabindex="-1"></a><span class="co">#Add effects column</span></span>
<span id="cb36-90"><a href="09-Supp_fig_3.html#cb36-90" tabindex="-1"></a>days_df<span class="sc">$</span>effect <span class="ot">&lt;-</span> <span class="st">&quot;Storagedays&quot;</span></span>
<span id="cb36-91"><a href="09-Supp_fig_3.html#cb36-91" tabindex="-1"></a><span class="co">#Add comparison column</span></span>
<span id="cb36-92"><a href="09-Supp_fig_3.html#cb36-92" tabindex="-1"></a>days_df<span class="sc">$</span>comparison <span class="ot">&lt;-</span> <span class="fu">paste0</span>(days_df<span class="sc">$</span>DaysstoredpriortoDNAextraction, <span class="st">&quot;_&quot;</span>,</span>
<span id="cb36-93"><a href="09-Supp_fig_3.html#cb36-93" tabindex="-1"></a>                                   days_df<span class="sc">$</span>DaysstoredpriortoDNAextraction_comp)</span>
<span id="cb36-94"><a href="09-Supp_fig_3.html#cb36-94" tabindex="-1"></a><span class="co">#Add pairs column</span></span>
<span id="cb36-95"><a href="09-Supp_fig_3.html#cb36-95" tabindex="-1"></a>days_df<span class="sc">$</span>sample_pair <span class="ot">&lt;-</span> <span class="fu">paste0</span>(days_df<span class="sc">$</span>Sample_name, <span class="st">&quot;_&quot;</span>, days_df<span class="sc">$</span>Sample_name_comp)</span>
<span id="cb36-96"><a href="09-Supp_fig_3.html#cb36-96" tabindex="-1"></a><span class="co">#Create df  to add to main df</span></span>
<span id="cb36-97"><a href="09-Supp_fig_3.html#cb36-97" tabindex="-1"></a>tmp_dist_df <span class="ot">&lt;-</span> days_df[,<span class="fu">c</span>(<span class="st">&quot;wunifrac&quot;</span>, <span class="st">&quot;effect&quot;</span>, <span class="st">&quot;comparison&quot;</span>, <span class="st">&quot;sample_pair&quot;</span>)]</span>
<span id="cb36-98"><a href="09-Supp_fig_3.html#cb36-98" tabindex="-1"></a><span class="co">#Add to dist data frame</span></span>
<span id="cb36-99"><a href="09-Supp_fig_3.html#cb36-99" tabindex="-1"></a>dist_df_long <span class="ot">&lt;-</span> <span class="fu">rbind</span>(dist_df_long, tmp_dist_df)</span>
<span id="cb36-100"><a href="09-Supp_fig_3.html#cb36-100" tabindex="-1"></a></span>
<span id="cb36-101"><a href="09-Supp_fig_3.html#cb36-101" tabindex="-1"></a><span class="co">#Remove unwanted objects</span></span>
<span id="cb36-102"><a href="09-Supp_fig_3.html#cb36-102" tabindex="-1"></a><span class="fu">rm</span>(wunifrac_long_df, participant_df, buffer_df, temp_df, days_df, tmp_dist_df)</span></code></pre></div>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="09-Supp_fig_3.html#cb37-1" tabindex="-1"></a><span class="co">#Create violin plot</span></span>
<span id="cb37-2"><a href="09-Supp_fig_3.html#cb37-2" tabindex="-1"></a>alpha_violin <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dist_df_long, <span class="fu">aes</span>(<span class="at">y =</span> wunifrac, <span class="at">x =</span> effect)) <span class="sc">+</span></span>
<span id="cb37-3"><a href="09-Supp_fig_3.html#cb37-3" tabindex="-1"></a>                ggplot2<span class="sc">::</span><span class="fu">geom_violin</span>() <span class="sc">+</span></span>
<span id="cb37-4"><a href="09-Supp_fig_3.html#cb37-4" tabindex="-1"></a>                ggforce<span class="sc">::</span><span class="fu">geom_sina</span>(<span class="at">alpha=</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb37-5"><a href="09-Supp_fig_3.html#cb37-5" tabindex="-1"></a>                <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Effect&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Weighted unifrac distance&quot;</span>)</span></code></pre></div>
</div>
<div id="buffer-deep-dive" class="section level3 hasAnchor" number="9.2.3">
<h3><span class="header-section-number">9.2.3</span> Buffer deep dive<a href="09-Supp_fig_3.html#buffer-deep-dive" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Here we want to look at the differences between the buffers.
We want boxplots with the same values as the above one but separated by the comparison e.g.</p>
<ul>
<li>No buffer vs Ethanol</li>
<li>No buffer vs PSP</li>
<li>etc.</li>
</ul>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="09-Supp_fig_3.html#cb38-1" tabindex="-1"></a><span class="co">#Subset our data to only contian the buffer effect info</span></span>
<span id="cb38-2"><a href="09-Supp_fig_3.html#cb38-2" tabindex="-1"></a>buffer_dist_df_long <span class="ot">&lt;-</span> dist_df_long[dist_df_long<span class="sc">$</span>effect <span class="sc">==</span> <span class="st">&quot;Bufferused&quot;</span>, ]</span>
<span id="cb38-3"><a href="09-Supp_fig_3.html#cb38-3" tabindex="-1"></a><span class="co">#Change names and order of levels</span></span>
<span id="cb38-4"><a href="09-Supp_fig_3.html#cb38-4" tabindex="-1"></a>buffer_dist_df_long<span class="sc">$</span>comparison <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="at">pattern =</span> <span class="st">&quot;Ethanol_No buffer&quot;</span>,</span>
<span id="cb38-5"><a href="09-Supp_fig_3.html#cb38-5" tabindex="-1"></a>                                       <span class="at">replacement =</span> <span class="st">&quot;No buffer &amp; Ethanol&quot;</span>,</span>
<span id="cb38-6"><a href="09-Supp_fig_3.html#cb38-6" tabindex="-1"></a>                                       <span class="at">x =</span> buffer_dist_df_long<span class="sc">$</span>comparison)</span>
<span id="cb38-7"><a href="09-Supp_fig_3.html#cb38-7" tabindex="-1"></a>buffer_dist_df_long<span class="sc">$</span>comparison <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="at">pattern =</span> <span class="st">&quot;Ethanol_PSP&quot;</span>,</span>
<span id="cb38-8"><a href="09-Supp_fig_3.html#cb38-8" tabindex="-1"></a>                                       <span class="at">replacement =</span> <span class="st">&quot;Ethanol &amp; PSP&quot;</span>,</span>
<span id="cb38-9"><a href="09-Supp_fig_3.html#cb38-9" tabindex="-1"></a>                                       <span class="at">x =</span> buffer_dist_df_long<span class="sc">$</span>comparison)</span>
<span id="cb38-10"><a href="09-Supp_fig_3.html#cb38-10" tabindex="-1"></a>buffer_dist_df_long<span class="sc">$</span>comparison <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="at">pattern =</span> <span class="st">&quot;Ethanol_RNAlater&quot;</span>,</span>
<span id="cb38-11"><a href="09-Supp_fig_3.html#cb38-11" tabindex="-1"></a>                                       <span class="at">replacement =</span> <span class="st">&quot;Ethanol &amp; RNAlater&quot;</span>,</span>
<span id="cb38-12"><a href="09-Supp_fig_3.html#cb38-12" tabindex="-1"></a>                                       <span class="at">x =</span> buffer_dist_df_long<span class="sc">$</span>comparison)</span>
<span id="cb38-13"><a href="09-Supp_fig_3.html#cb38-13" tabindex="-1"></a>buffer_dist_df_long<span class="sc">$</span>comparison <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="at">pattern =</span> <span class="st">&quot;PSP_No buffer&quot;</span>,</span>
<span id="cb38-14"><a href="09-Supp_fig_3.html#cb38-14" tabindex="-1"></a>                                       <span class="at">replacement =</span> <span class="st">&quot;No buffer &amp; PSP&quot;</span>,</span>
<span id="cb38-15"><a href="09-Supp_fig_3.html#cb38-15" tabindex="-1"></a>                                       <span class="at">x =</span> buffer_dist_df_long<span class="sc">$</span>comparison)</span>
<span id="cb38-16"><a href="09-Supp_fig_3.html#cb38-16" tabindex="-1"></a>buffer_dist_df_long<span class="sc">$</span>comparison <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="at">pattern =</span> <span class="st">&quot;RNAlater_No buffer&quot;</span>,</span>
<span id="cb38-17"><a href="09-Supp_fig_3.html#cb38-17" tabindex="-1"></a>                                       <span class="at">replacement =</span> <span class="st">&quot;No buffer &amp; RNAlater&quot;</span>,</span>
<span id="cb38-18"><a href="09-Supp_fig_3.html#cb38-18" tabindex="-1"></a>                                       <span class="at">x =</span> buffer_dist_df_long<span class="sc">$</span>comparison)</span>
<span id="cb38-19"><a href="09-Supp_fig_3.html#cb38-19" tabindex="-1"></a>buffer_dist_df_long<span class="sc">$</span>comparison <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="at">pattern =</span> <span class="st">&quot;RNAlater_PSP&quot;</span>,</span>
<span id="cb38-20"><a href="09-Supp_fig_3.html#cb38-20" tabindex="-1"></a>                                       <span class="at">replacement =</span> <span class="st">&quot;PSP &amp; RNAlater&quot;</span>,</span>
<span id="cb38-21"><a href="09-Supp_fig_3.html#cb38-21" tabindex="-1"></a>                                       <span class="at">x =</span> buffer_dist_df_long<span class="sc">$</span>comparison)</span>
<span id="cb38-22"><a href="09-Supp_fig_3.html#cb38-22" tabindex="-1"></a><span class="co">#Change to factor and reorder</span></span>
<span id="cb38-23"><a href="09-Supp_fig_3.html#cb38-23" tabindex="-1"></a>buffer_dist_df_long<span class="sc">$</span>comparison <span class="ot">&lt;-</span> <span class="fu">factor</span>(buffer_dist_df_long<span class="sc">$</span>comparison, </span>
<span id="cb38-24"><a href="09-Supp_fig_3.html#cb38-24" tabindex="-1"></a>       <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;No buffer &amp; Ethanol&quot;</span>, <span class="st">&quot;No buffer &amp; PSP&quot;</span>, <span class="st">&quot;No buffer &amp; RNAlater&quot;</span>,</span>
<span id="cb38-25"><a href="09-Supp_fig_3.html#cb38-25" tabindex="-1"></a>                  <span class="st">&quot;Ethanol &amp; PSP&quot;</span>, <span class="st">&quot;Ethanol &amp; RNAlater&quot;</span>, <span class="st">&quot;PSP &amp; RNAlater&quot;</span>))</span>
<span id="cb38-26"><a href="09-Supp_fig_3.html#cb38-26" tabindex="-1"></a><span class="co">#Create violin plot</span></span>
<span id="cb38-27"><a href="09-Supp_fig_3.html#cb38-27" tabindex="-1"></a>buffer_alpha_violin <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(buffer_dist_df_long, <span class="fu">aes</span>(<span class="at">y =</span> wunifrac, <span class="at">x =</span> comparison)) <span class="sc">+</span></span>
<span id="cb38-28"><a href="09-Supp_fig_3.html#cb38-28" tabindex="-1"></a>                ggplot2<span class="sc">::</span><span class="fu">geom_violin</span>() <span class="sc">+</span></span>
<span id="cb38-29"><a href="09-Supp_fig_3.html#cb38-29" tabindex="-1"></a>                ggforce<span class="sc">::</span><span class="fu">geom_sina</span>(<span class="at">alpha=</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb38-30"><a href="09-Supp_fig_3.html#cb38-30" tabindex="-1"></a>                <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Bufferused comparison&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Weighted unifrac distance&quot;</span>)</span></code></pre></div>
</div>
<div id="combined-plot" class="section level3 hasAnchor" number="9.2.4">
<h3><span class="header-section-number">9.2.4</span> Combined plot<a href="09-Supp_fig_3.html#combined-plot" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Combine the 2 plots into one figure</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="09-Supp_fig_3.html#cb39-1" tabindex="-1"></a>combined_alpha_violin <span class="ot">&lt;-</span> alpha_violin <span class="sc">/</span> buffer_alpha_violin</span>
<span id="cb39-2"><a href="09-Supp_fig_3.html#cb39-2" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="st">&quot;./figures/16s_beta_intergroup_divergence_violin_plots.png&quot;</span>, </span>
<span id="cb39-3"><a href="09-Supp_fig_3.html#cb39-3" tabindex="-1"></a>       <span class="at">plot =</span> combined_alpha_violin,</span>
<span id="cb39-4"><a href="09-Supp_fig_3.html#cb39-4" tabindex="-1"></a>       <span class="at">device =</span> <span class="st">&quot;png&quot;</span>, <span class="at">dpi =</span> <span class="dv">300</span>, <span class="at">units =</span> <span class="st">&quot;mm&quot;</span>, <span class="at">height =</span> <span class="dv">250</span>, <span class="at">width =</span> <span class="dv">250</span>)</span></code></pre></div>
<p><img src="figures/16s_beta_intergroup_divergence_violin_plots.png" width="100%" style="display: block; margin: auto;" /></p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="08-Supp_fig_2.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="10-Supp_fig_4.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": null,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": null,
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

</body>

</html>
