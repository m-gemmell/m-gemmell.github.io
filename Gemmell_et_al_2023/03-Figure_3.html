<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 3 Figure 3 | Optimised human stool sample collection for multi-omic microbiota analysis R code</title>
  <meta name="description" content="Book to contain visualisation for the “ANCOM” project" />
  <meta name="generator" content="bookdown 0.36 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 3 Figure 3 | Optimised human stool sample collection for multi-omic microbiota analysis R code" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Book to contain visualisation for the “ANCOM” project" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 Figure 3 | Optimised human stool sample collection for multi-omic microbiota analysis R code" />
  
  <meta name="twitter:description" content="Book to contain visualisation for the “ANCOM” project" />
  

<meta name="author" content="Matthew R. Gemmell" />


<meta name="date" content="2024-07-12" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="02-Phyloseqize.html"/>
<link rel="next" href="04-Figure_4.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.6.2/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.28/datatables.js"></script>
<link href="libs/dt-core-1.13.4/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.13.4/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.13.4/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a>Optimised human stool sample collection for multi-omic microbiota analysis R code</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="01-Intro.html"><a href="01-Intro.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="02-Phyloseqize.html"><a href="02-Phyloseqize.html"><i class="fa fa-check"></i><b>2</b> Importing and preocessing data</a>
<ul>
<li class="chapter" data-level="2.1" data-path="02-Phyloseqize.html"><a href="02-Phyloseqize.html#qiime2r-import"><i class="fa fa-check"></i><b>2.1</b> qiime2R import</a></li>
<li class="chapter" data-level="2.2" data-path="02-Phyloseqize.html"><a href="02-Phyloseqize.html#preprocess-data"><i class="fa fa-check"></i><b>2.2</b> Preprocess data</a></li>
<li class="chapter" data-level="2.3" data-path="02-Phyloseqize.html"><a href="02-Phyloseqize.html#lipid-data"><i class="fa fa-check"></i><b>2.3</b> Lipid data</a></li>
</ul></li>
<li class="part"><span><b>Main figures</b></span></li>
<li class="chapter" data-level="3" data-path="03-Figure_3.html"><a href="03-Figure_3.html"><i class="fa fa-check"></i><b>3</b> Figure 3</a>
<ul>
<li class="chapter" data-level="3.1" data-path="03-Figure_3.html"><a href="03-Figure_3.html#libraries"><i class="fa fa-check"></i><b>3.1</b> Libraries</a></li>
<li class="chapter" data-level="3.2" data-path="03-Figure_3.html"><a href="03-Figure_3.html#figure-3a"><i class="fa fa-check"></i><b>3.2</b> Figure 3A</a></li>
<li class="chapter" data-level="3.3" data-path="03-Figure_3.html"><a href="03-Figure_3.html#figure-3b"><i class="fa fa-check"></i><b>3.3</b> Figure 3B</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="03-Figure_3.html"><a href="03-Figure_3.html#percentage-of-bacteroides-and-firmicutes"><i class="fa fa-check"></i><b>3.3.1</b> Percentage of Bacteroides and Firmicutes</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="03-Figure_3.html"><a href="03-Figure_3.html#figure-3c"><i class="fa fa-check"></i><b>3.4</b> Figure 3C</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="04-Figure_4.html"><a href="04-Figure_4.html"><i class="fa fa-check"></i><b>4</b> Figure 4</a>
<ul>
<li class="chapter" data-level="4.1" data-path="04-Figure_4.html"><a href="04-Figure_4.html#libraries-1"><i class="fa fa-check"></i><b>4.1</b> Libraries</a></li>
<li class="chapter" data-level="4.2" data-path="04-Figure_4.html"><a href="04-Figure_4.html#genus"><i class="fa fa-check"></i><b>4.2</b> Genus</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="04-Figure_4.html"><a href="04-Figure_4.html#preprocess-table-and-convert-to-genus-table"><i class="fa fa-check"></i><b>4.2.1</b> Preprocess table and convert to genus table</a></li>
<li class="chapter" data-level="4.2.2" data-path="04-Figure_4.html"><a href="04-Figure_4.html#maaslin2-on-genera"><i class="fa fa-check"></i><b>4.2.2</b> MaAsLin2 on genera</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="05-Figure_5.html"><a href="05-Figure_5.html"><i class="fa fa-check"></i><b>5</b> Figure 5</a>
<ul>
<li class="chapter" data-level="5.1" data-path="05-Figure_5.html"><a href="05-Figure_5.html#libraries-2"><i class="fa fa-check"></i><b>5.1</b> libraries</a></li>
<li class="chapter" data-level="5.2" data-path="05-Figure_5.html"><a href="05-Figure_5.html#preprocess-data-1"><i class="fa fa-check"></i><b>5.2</b> Preprocess data</a></li>
<li class="chapter" data-level="5.3" data-path="05-Figure_5.html"><a href="05-Figure_5.html#colour-blindy-friendly-palettes"><i class="fa fa-check"></i><b>5.3</b> Colour blindy friendly palettes</a></li>
<li class="chapter" data-level="5.4" data-path="05-Figure_5.html"><a href="05-Figure_5.html#a-heatmap"><i class="fa fa-check"></i><b>5.4</b> A Heatmap</a></li>
<li class="chapter" data-level="5.5" data-path="05-Figure_5.html"><a href="05-Figure_5.html#b-c"><i class="fa fa-check"></i><b>5.5</b> B &amp; C</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="05-Figure_5.html"><a href="05-Figure_5.html#b-pcoa-plot"><i class="fa fa-check"></i><b>5.5.1</b> B PCoA plot</a></li>
<li class="chapter" data-level="5.5.2" data-path="05-Figure_5.html"><a href="05-Figure_5.html#c-pcoa-plot"><i class="fa fa-check"></i><b>5.5.2</b> C PCoA plot</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="05-Figure_5.html"><a href="05-Figure_5.html#without-ethanol"><i class="fa fa-check"></i><b>5.6</b> Without ethanol</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="06-Figure_6.html"><a href="06-Figure_6.html"><i class="fa fa-check"></i><b>6</b> Figure 6</a>
<ul>
<li class="chapter" data-level="6.1" data-path="06-Figure_6.html"><a href="06-Figure_6.html#libraries-3"><i class="fa fa-check"></i><b>6.1</b> Libraries</a></li>
<li class="chapter" data-level="6.2" data-path="06-Figure_6.html"><a href="06-Figure_6.html#preprocess-tables"><i class="fa fa-check"></i><b>6.2</b> Preprocess tables</a></li>
<li class="chapter" data-level="6.3" data-path="06-Figure_6.html"><a href="06-Figure_6.html#all-buffers"><i class="fa fa-check"></i><b>6.3</b> All buffers</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="06-Figure_6.html"><a href="06-Figure_6.html#correlation"><i class="fa fa-check"></i><b>6.3.1</b> Correlation</a></li>
<li class="chapter" data-level="6.3.2" data-path="06-Figure_6.html"><a href="06-Figure_6.html#heatmap"><i class="fa fa-check"></i><b>6.3.2</b> Heatmap</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>Supplementary figures</b></span></li>
<li class="chapter" data-level="7" data-path="07-Supp_fig_1.html"><a href="07-Supp_fig_1.html"><i class="fa fa-check"></i><b>7</b> Supp figure 1</a>
<ul>
<li class="chapter" data-level="7.1" data-path="07-Supp_fig_1.html"><a href="07-Supp_fig_1.html#libraries-4"><i class="fa fa-check"></i><b>7.1</b> Libraries</a></li>
<li class="chapter" data-level="7.2" data-path="07-Supp_fig_1.html"><a href="07-Supp_fig_1.html#rarefactipon-plot"><i class="fa fa-check"></i><b>7.2</b> Rarefactipon plot</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="08-Supp_fig_2.html"><a href="08-Supp_fig_2.html"><i class="fa fa-check"></i><b>8</b> Supp figure 2</a>
<ul>
<li class="chapter" data-level="8.1" data-path="08-Supp_fig_2.html"><a href="08-Supp_fig_2.html#libraries-5"><i class="fa fa-check"></i><b>8.1</b> Libraries</a></li>
<li class="chapter" data-level="8.2" data-path="08-Supp_fig_2.html"><a href="08-Supp_fig_2.html#weighted-unifrac-plots-with-relative-abundance"><i class="fa fa-check"></i><b>8.2</b> Weighted unifrac plots with relative abundance</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="08-Supp_fig_2.html"><a href="08-Supp_fig_2.html#figure-a-buffer-used-faceted-by-patient"><i class="fa fa-check"></i><b>8.2.1</b> Figure A: Buffer used faceted by patient</a></li>
<li class="chapter" data-level="8.2.2" data-path="08-Supp_fig_2.html"><a href="08-Supp_fig_2.html#figure-b-storage-temperature"><i class="fa fa-check"></i><b>8.2.2</b> Figure B: Storage temperature</a></li>
<li class="chapter" data-level="8.2.3" data-path="08-Supp_fig_2.html"><a href="08-Supp_fig_2.html#figure-c-storage-conditions"><i class="fa fa-check"></i><b>8.2.3</b> Figure C: Storage conditions</a></li>
<li class="chapter" data-level="8.2.4" data-path="08-Supp_fig_2.html"><a href="08-Supp_fig_2.html#figure-d-buffer-and-storage-condition-faceted-by-patient"><i class="fa fa-check"></i><b>8.2.4</b> Figure D: Buffer and storage condition faceted by patient</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="09-Supp_fig_3.html"><a href="09-Supp_fig_3.html"><i class="fa fa-check"></i><b>9</b> Supp figure 3</a>
<ul>
<li class="chapter" data-level="9.1" data-path="09-Supp_fig_3.html"><a href="09-Supp_fig_3.html#libraries-6"><i class="fa fa-check"></i><b>9.1</b> Libraries</a></li>
<li class="chapter" data-level="9.2" data-path="09-Supp_fig_3.html"><a href="09-Supp_fig_3.html#s-composition"><i class="fa fa-check"></i><b>9.2</b> 16S composition</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="09-Supp_fig_3.html"><a href="09-Supp_fig_3.html#table-of-all-paired-distances"><i class="fa fa-check"></i><b>9.2.1</b> Table of all paired distances</a></li>
<li class="chapter" data-level="9.2.2" data-path="09-Supp_fig_3.html"><a href="09-Supp_fig_3.html#extract-the-paired-distances"><i class="fa fa-check"></i><b>9.2.2</b> Extract the paired distances</a></li>
<li class="chapter" data-level="9.2.3" data-path="09-Supp_fig_3.html"><a href="09-Supp_fig_3.html#buffer-deep-dive"><i class="fa fa-check"></i><b>9.2.3</b> Buffer deep dive</a></li>
<li class="chapter" data-level="9.2.4" data-path="09-Supp_fig_3.html"><a href="09-Supp_fig_3.html#combined-plot"><i class="fa fa-check"></i><b>9.2.4</b> Combined plot</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="10-Supp_fig_4.html"><a href="10-Supp_fig_4.html"><i class="fa fa-check"></i><b>10</b> Supp figure 4</a>
<ul>
<li class="chapter" data-level="10.1" data-path="10-Supp_fig_4.html"><a href="10-Supp_fig_4.html#libraries-7"><i class="fa fa-check"></i><b>10.1</b> Libraries</a></li>
<li class="chapter" data-level="10.2" data-path="10-Supp_fig_4.html"><a href="10-Supp_fig_4.html#alpha-diveristy-plots"><i class="fa fa-check"></i><b>10.2</b> Alpha diveristy plots</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="10-Supp_fig_4.html"><a href="10-Supp_fig_4.html#a-storage-conditions"><i class="fa fa-check"></i><b>10.2.1</b> A: Storage conditions</a></li>
<li class="chapter" data-level="10.2.2" data-path="10-Supp_fig_4.html"><a href="10-Supp_fig_4.html#b-participant-number"><i class="fa fa-check"></i><b>10.2.2</b> B: Participant number</a></li>
<li class="chapter" data-level="10.2.3" data-path="10-Supp_fig_4.html"><a href="10-Supp_fig_4.html#c-storage-temp"><i class="fa fa-check"></i><b>10.2.3</b> C: Storage temp</a></li>
<li class="chapter" data-level="10.2.4" data-path="10-Supp_fig_4.html"><a href="10-Supp_fig_4.html#d-buffer-and-storage"><i class="fa fa-check"></i><b>10.2.4</b> D: Buffer and storage</a></li>
<li class="chapter" data-level="10.2.5" data-path="10-Supp_fig_4.html"><a href="10-Supp_fig_4.html#e-buffer-and-participant"><i class="fa fa-check"></i><b>10.2.5</b> E: Buffer and participant</a></li>
<li class="chapter" data-level="10.2.6" data-path="10-Supp_fig_4.html"><a href="10-Supp_fig_4.html#f-storage-condition-and-participant"><i class="fa fa-check"></i><b>10.2.6</b> F: storage condition and participant</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="11-Supp_fig_5.html"><a href="11-Supp_fig_5.html"><i class="fa fa-check"></i><b>11</b> Supp figure 5</a>
<ul>
<li class="chapter" data-level="11.1" data-path="11-Supp_fig_5.html"><a href="11-Supp_fig_5.html#libraries-8"><i class="fa fa-check"></i><b>11.1</b> Libraries</a></li>
<li class="chapter" data-level="11.2" data-path="11-Supp_fig_5.html"><a href="11-Supp_fig_5.html#barchart-of-genera-biomarkers"><i class="fa fa-check"></i><b>11.2</b> Barchart of Genera biomarkers</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="12-Supp_fig_6.html"><a href="12-Supp_fig_6.html"><i class="fa fa-check"></i><b>12</b> Supp figure 6</a>
<ul>
<li class="chapter" data-level="12.1" data-path="12-Supp_fig_6.html"><a href="12-Supp_fig_6.html#intra-group-variability"><i class="fa fa-check"></i><b>12.1</b> Intra group variability</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="13-Supp_fig_7.html"><a href="13-Supp_fig_7.html"><i class="fa fa-check"></i><b>13</b> Supp figure 7</a>
<ul>
<li class="chapter" data-level="13.1" data-path="13-Supp_fig_7.html"><a href="13-Supp_fig_7.html#libraries-9"><i class="fa fa-check"></i><b>13.1</b> Libraries</a></li>
<li class="chapter" data-level="13.2" data-path="13-Supp_fig_7.html"><a href="13-Supp_fig_7.html#scfa-analysis"><i class="fa fa-check"></i><b>13.2</b> SCFA analysis</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="13-Supp_fig_7.html"><a href="13-Supp_fig_7.html#table-of-all-paired-distances-1"><i class="fa fa-check"></i><b>13.2.1</b> Table of all paired distances</a></li>
<li class="chapter" data-level="13.2.2" data-path="13-Supp_fig_7.html"><a href="13-Supp_fig_7.html#extract-the-paired-distances-1"><i class="fa fa-check"></i><b>13.2.2</b> Extract the paired distances</a></li>
<li class="chapter" data-level="13.2.3" data-path="13-Supp_fig_7.html"><a href="13-Supp_fig_7.html#buffer-deep-dive-1"><i class="fa fa-check"></i><b>13.2.3</b> Buffer deep dive</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="13-Supp_fig_7.html"><a href="13-Supp_fig_7.html#combine-plots"><i class="fa fa-check"></i><b>13.3</b> Combine plots</a></li>
</ul></li>
<li class="part"><span><b>Supplementary tables</b></span></li>
<li class="chapter" data-level="14" data-path="14-Supp_table_2.html"><a href="14-Supp_table_2.html"><i class="fa fa-check"></i><b>14</b> Supp table 2</a>
<ul>
<li class="chapter" data-level="14.1" data-path="14-Supp_table_2.html"><a href="14-Supp_table_2.html#libraries-10"><i class="fa fa-check"></i><b>14.1</b> Libraries</a>
<ul>
<li class="chapter" data-level="14.1.1" data-path="14-Supp_table_2.html"><a href="14-Supp_table_2.html#statistical-test"><i class="fa fa-check"></i><b>14.1.1</b> Statistical test</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="15" data-path="15-Supp_table_3.html"><a href="15-Supp_table_3.html"><i class="fa fa-check"></i><b>15</b> Supp table 3</a>
<ul>
<li class="chapter" data-level="15.1" data-path="15-Supp_table_3.html"><a href="15-Supp_table_3.html#libraries-11"><i class="fa fa-check"></i><b>15.1</b> Libraries</a>
<ul>
<li class="chapter" data-level="15.1.1" data-path="15-Supp_table_3.html"><a href="15-Supp_table_3.html#paired-wilcox-tests"><i class="fa fa-check"></i><b>15.1.1</b> Paired wilcox tests</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="16" data-path="16-Supp_table_4.html"><a href="16-Supp_table_4.html"><i class="fa fa-check"></i><b>16</b> Supp table 4</a>
<ul>
<li class="chapter" data-level="16.1" data-path="16-Supp_table_4.html"><a href="16-Supp_table_4.html#libraries-12"><i class="fa fa-check"></i><b>16.1</b> Libraries</a></li>
<li class="chapter" data-level="16.2" data-path="16-Supp_table_4.html"><a href="16-Supp_table_4.html#significant-results-table"><i class="fa fa-check"></i><b>16.2</b> Significant results table</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="17-Supp_table_6.html"><a href="17-Supp_table_6.html"><i class="fa fa-check"></i><b>17</b> Supp table 6</a>
<ul>
<li class="chapter" data-level="17.1" data-path="17-Supp_table_6.html"><a href="17-Supp_table_6.html#libraries-13"><i class="fa fa-check"></i><b>17.1</b> libraries</a>
<ul>
<li class="chapter" data-level="17.1.1" data-path="17-Supp_table_6.html"><a href="17-Supp_table_6.html#statisitical-tests"><i class="fa fa-check"></i><b>17.1.1</b> Statisitical tests</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="18" data-path="18-Supp_table_7.html"><a href="18-Supp_table_7.html"><i class="fa fa-check"></i><b>18</b> Supp table 7</a></li>
<li class="chapter" data-level="19" data-path="19-Supp_table_8.html"><a href="19-Supp_table_8.html"><i class="fa fa-check"></i><b>19</b> Supp table 8</a>
<ul>
<li class="chapter" data-level="19.1" data-path="19-Supp_table_8.html"><a href="19-Supp_table_8.html#libraries-14"><i class="fa fa-check"></i><b>19.1</b> Libraries</a></li>
<li class="chapter" data-level="19.2" data-path="19-Supp_table_8.html"><a href="19-Supp_table_8.html#preprocess-tables-1"><i class="fa fa-check"></i><b>19.2</b> Preprocess tables</a></li>
<li class="chapter" data-level="19.3" data-path="19-Supp_table_8.html"><a href="19-Supp_table_8.html#no-buffer"><i class="fa fa-check"></i><b>19.3</b> No buffer</a>
<ul>
<li class="chapter" data-level="19.3.1" data-path="19-Supp_table_8.html"><a href="19-Supp_table_8.html#correlation-1"><i class="fa fa-check"></i><b>19.3.1</b> Correlation</a></li>
</ul></li>
<li class="chapter" data-level="19.4" data-path="19-Supp_table_8.html"><a href="19-Supp_table_8.html#rnalater"><i class="fa fa-check"></i><b>19.4</b> RNAlater</a>
<ul>
<li class="chapter" data-level="19.4.1" data-path="19-Supp_table_8.html"><a href="19-Supp_table_8.html#correlation-2"><i class="fa fa-check"></i><b>19.4.1</b> Correlation</a></li>
</ul></li>
<li class="chapter" data-level="19.5" data-path="19-Supp_table_8.html"><a href="19-Supp_table_8.html#ethanol"><i class="fa fa-check"></i><b>19.5</b> Ethanol</a>
<ul>
<li class="chapter" data-level="19.5.1" data-path="19-Supp_table_8.html"><a href="19-Supp_table_8.html#correlation-3"><i class="fa fa-check"></i><b>19.5.1</b> Correlation</a></li>
</ul></li>
<li class="chapter" data-level="19.6" data-path="19-Supp_table_8.html"><a href="19-Supp_table_8.html#psp"><i class="fa fa-check"></i><b>19.6</b> PSP</a>
<ul>
<li class="chapter" data-level="19.6.1" data-path="19-Supp_table_8.html"><a href="19-Supp_table_8.html#correlation-4"><i class="fa fa-check"></i><b>19.6.1</b> Correlation</a></li>
</ul></li>
<li class="chapter" data-level="19.7" data-path="19-Supp_table_8.html"><a href="19-Supp_table_8.html#compare-results"><i class="fa fa-check"></i><b>19.7</b> Compare results</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Optimised human stool sample collection for multi-omic microbiota analysis R code</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="figure-3" class="section level1 hasAnchor" number="3">
<h1><span class="header-section-number">Chapter 3</span> Figure 3<a href="03-Figure_3.html#figure-3" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Gut microbiota composition in study subjects. (A) Principal component analysis of stool microbiota composition based on DADA2 produced ASVs. (B) Relative abundance at the order level derived from 16S rRNA gene sequences within each sample. Bar charts are faceted by participant (1–6) and buffer used metadata information. (C) Diversity (observed species, chao1 and Shannon) of the microbiota of stool samples stratified by storage buffer (ethanol, no buffer, PSP buffer, RNAlater).</p>
<p><img src="figures/Figure%203.jpg" width="100%" style="display: block; margin: auto;" /></p>
<div id="libraries" class="section level2 hasAnchor" number="3.1">
<h2><span class="header-section-number">3.1</span> Libraries<a href="03-Figure_3.html#libraries" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="03-Figure_3.html#cb4-1" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;phyloseq&quot;</span>)</span>
<span id="cb4-2"><a href="03-Figure_3.html#cb4-2" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;microbiome&quot;</span>)</span>
<span id="cb4-3"><a href="03-Figure_3.html#cb4-3" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;ggplot2&quot;</span>)</span>
<span id="cb4-4"><a href="03-Figure_3.html#cb4-4" tabindex="-1"></a><span class="co">#library(&quot;plotly&quot;)</span></span>
<span id="cb4-5"><a href="03-Figure_3.html#cb4-5" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;tidyverse&quot;</span>)</span>
<span id="cb4-6"><a href="03-Figure_3.html#cb4-6" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;ggforce&quot;</span>)</span>
<span id="cb4-7"><a href="03-Figure_3.html#cb4-7" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;ggh4x&quot;</span>)</span>
<span id="cb4-8"><a href="03-Figure_3.html#cb4-8" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;patchwork&quot;</span>)</span></code></pre></div>
</div>
<div id="figure-3a" class="section level2 hasAnchor" number="3.2">
<h2><span class="header-section-number">3.2</span> Figure 3A<a href="03-Figure_3.html#figure-3a" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="03-Figure_3.html#cb5-1" tabindex="-1"></a><span class="co">#Load in data</span></span>
<span id="cb5-2"><a href="03-Figure_3.html#cb5-2" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&quot;./data/preprocess_physeq&quot;</span>)</span>
<span id="cb5-3"><a href="03-Figure_3.html#cb5-3" tabindex="-1"></a></span>
<span id="cb5-4"><a href="03-Figure_3.html#cb5-4" tabindex="-1"></a><span class="co">#Transform samples to even sampling depth</span></span>
<span id="cb5-5"><a href="03-Figure_3.html#cb5-5" tabindex="-1"></a>physeq <span class="ot">&lt;-</span> <span class="fu">transform_sample_counts</span>(physeq,</span>
<span id="cb5-6"><a href="03-Figure_3.html#cb5-6" tabindex="-1"></a>                                  <span class="cf">function</span>(x) <span class="dv">30000</span> <span class="sc">*</span> x<span class="sc">/</span><span class="fu">sum</span>(x))</span>
<span id="cb5-7"><a href="03-Figure_3.html#cb5-7" tabindex="-1"></a><span class="co">#Save object</span></span>
<span id="cb5-8"><a href="03-Figure_3.html#cb5-8" tabindex="-1"></a><span class="fu">save</span>(physeq, <span class="at">file =</span> <span class="st">&quot;./data/preproces_physeq_even_depth30k&quot;</span>)</span>
<span id="cb5-9"><a href="03-Figure_3.html#cb5-9" tabindex="-1"></a><span class="co">#load in phyloseq object</span></span>
<span id="cb5-10"><a href="03-Figure_3.html#cb5-10" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&quot;./data/preproces_physeq_even_depth30k&quot;</span>)</span>
<span id="cb5-11"><a href="03-Figure_3.html#cb5-11" tabindex="-1"></a></span>
<span id="cb5-12"><a href="03-Figure_3.html#cb5-12" tabindex="-1"></a><span class="co">#Produce Weighted unifrac oridnation</span></span>
<span id="cb5-13"><a href="03-Figure_3.html#cb5-13" tabindex="-1"></a>ord <span class="ot">&lt;-</span> <span class="fu">ordinate</span>(physeq, <span class="st">&quot;PCoA&quot;</span>, <span class="st">&quot;wunifrac&quot;</span>)</span>
<span id="cb5-14"><a href="03-Figure_3.html#cb5-14" tabindex="-1"></a></span>
<span id="cb5-15"><a href="03-Figure_3.html#cb5-15" tabindex="-1"></a><span class="co">#Use Paul Tol colour blind palette</span></span>
<span id="cb5-16"><a href="03-Figure_3.html#cb5-16" tabindex="-1"></a>tol_pal <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;#4477AA&quot;</span>,<span class="st">&quot;#66CCEE&quot;</span>,<span class="st">&quot;#228833&quot;</span>,<span class="st">&quot;#CCBB44&quot;</span>,<span class="st">&quot;#EE6677&quot;</span>,<span class="st">&quot;#AA3377&quot;</span>)</span>
<span id="cb5-17"><a href="03-Figure_3.html#cb5-17" tabindex="-1"></a></span>
<span id="cb5-18"><a href="03-Figure_3.html#cb5-18" tabindex="-1"></a><span class="co">#Create plot</span></span>
<span id="cb5-19"><a href="03-Figure_3.html#cb5-19" tabindex="-1"></a>p <span class="ot">&lt;-</span>  <span class="fu">plot_ordination</span>(physeq, ord, </span>
<span id="cb5-20"><a href="03-Figure_3.html#cb5-20" tabindex="-1"></a>                      <span class="at">color=</span><span class="st">&quot;Patientnumber&quot;</span>) <span class="sc">+</span></span>
<span id="cb5-21"><a href="03-Figure_3.html#cb5-21" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span>tol_pal)<span class="sc">+</span></span>
<span id="cb5-22"><a href="03-Figure_3.html#cb5-22" tabindex="-1"></a>  <span class="co">#Change legend title to Participant number</span></span>
<span id="cb5-23"><a href="03-Figure_3.html#cb5-23" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">colour=</span><span class="st">&quot;Participant</span><span class="sc">\n</span><span class="st">number&quot;</span>)</span>
<span id="cb5-24"><a href="03-Figure_3.html#cb5-24" tabindex="-1"></a></span>
<span id="cb5-25"><a href="03-Figure_3.html#cb5-25" tabindex="-1"></a><span class="co">#Save plot</span></span>
<span id="cb5-26"><a href="03-Figure_3.html#cb5-26" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">plot =</span> p,</span>
<span id="cb5-27"><a href="03-Figure_3.html#cb5-27" tabindex="-1"></a>       <span class="st">&quot;./figures/weighted_unifrac_patient.png&quot;</span>,</span>
<span id="cb5-28"><a href="03-Figure_3.html#cb5-28" tabindex="-1"></a>       <span class="at">device =</span> <span class="st">&quot;png&quot;</span>, <span class="at">units =</span> <span class="st">&quot;mm&quot;</span>, <span class="at">height =</span> <span class="dv">80</span>, <span class="at">width =</span> <span class="dv">100</span>, </span>
<span id="cb5-29"><a href="03-Figure_3.html#cb5-29" tabindex="-1"></a>       <span class="at">dpi =</span> <span class="dv">300</span>)</span></code></pre></div>
<p><img src="figures/weighted_unifrac_patient.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
<div id="figure-3b" class="section level2 hasAnchor" number="3.3">
<h2><span class="header-section-number">3.3</span> Figure 3B<a href="03-Figure_3.html#figure-3b" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="03-Figure_3.html#cb6-1" tabindex="-1"></a><span class="co">#Load in relative abundance phyloseq</span></span>
<span id="cb6-2"><a href="03-Figure_3.html#cb6-2" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&quot;./data/physeq_relabund&quot;</span>)</span>
<span id="cb6-3"><a href="03-Figure_3.html#cb6-3" tabindex="-1"></a></span>
<span id="cb6-4"><a href="03-Figure_3.html#cb6-4" tabindex="-1"></a><span class="co">#Aggregate taxa to order</span></span>
<span id="cb6-5"><a href="03-Figure_3.html#cb6-5" tabindex="-1"></a>physeq_order_relabund <span class="ot">&lt;-</span> <span class="fu">aggregate_taxa</span>(physeq_relabund, <span class="st">&#39;Order&#39;</span>)</span>
<span id="cb6-6"><a href="03-Figure_3.html#cb6-6" tabindex="-1"></a><span class="co">#Remove Appearing square brackets again</span></span>
<span id="cb6-7"><a href="03-Figure_3.html#cb6-7" tabindex="-1"></a><span class="fu">tax_table</span>(physeq_order_relabund)[,] <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="at">pattern =</span> <span class="st">&quot;</span><span class="sc">\\</span><span class="st">[&quot;</span> , <span class="at">replacement =</span> <span class="st">&quot;&quot;</span>, <span class="fu">tax_table</span>(physeq_order_relabund)[,])</span>
<span id="cb6-8"><a href="03-Figure_3.html#cb6-8" tabindex="-1"></a><span class="fu">tax_table</span>(physeq_order_relabund)[,] <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="at">pattern =</span> <span class="st">&quot;</span><span class="sc">\\</span><span class="st">]&quot;</span> , <span class="at">replacement =</span> <span class="st">&quot;&quot;</span>, <span class="fu">tax_table</span>(physeq_order_relabund)[,])</span>
<span id="cb6-9"><a href="03-Figure_3.html#cb6-9" tabindex="-1"></a><span class="fu">row.names</span>(<span class="fu">tax_table</span>(physeq_order_relabund)) <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="at">pattern =</span> <span class="st">&quot;</span><span class="sc">\\</span><span class="st">[&quot;</span> , <span class="at">replacement =</span> <span class="st">&quot;&quot;</span>, <span class="fu">row.names</span>(<span class="fu">tax_table</span>(physeq_order_relabund)))</span>
<span id="cb6-10"><a href="03-Figure_3.html#cb6-10" tabindex="-1"></a><span class="fu">row.names</span>(<span class="fu">tax_table</span>(physeq_order_relabund)) <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="at">pattern =</span> <span class="st">&quot;</span><span class="sc">\\</span><span class="st">]&quot;</span> , <span class="at">replacement =</span> <span class="st">&quot;&quot;</span>, <span class="fu">row.names</span>(<span class="fu">tax_table</span>(physeq_order_relabund)))</span>
<span id="cb6-11"><a href="03-Figure_3.html#cb6-11" tabindex="-1"></a></span>
<span id="cb6-12"><a href="03-Figure_3.html#cb6-12" tabindex="-1"></a>order_taxa_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">tax_table</span>(physeq_order_relabund))</span>
<span id="cb6-13"><a href="03-Figure_3.html#cb6-13" tabindex="-1"></a></span>
<span id="cb6-14"><a href="03-Figure_3.html#cb6-14" tabindex="-1"></a><span class="co">#Produce plot</span></span>
<span id="cb6-15"><a href="03-Figure_3.html#cb6-15" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">plot_bar</span>(physeq_order_relabund, <span class="at">x =</span> <span class="st">&quot;Sample_name&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;Order&quot;</span>)<span class="sc">+</span></span>
<span id="cb6-16"><a href="03-Figure_3.html#cb6-16" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">color=</span>Order, <span class="at">fill=</span>Order), <span class="at">stat=</span><span class="st">&quot;identity&quot;</span>, <span class="at">position=</span><span class="st">&quot;stack&quot;</span>) <span class="sc">+</span></span>
<span id="cb6-17"><a href="03-Figure_3.html#cb6-17" tabindex="-1"></a>  <span class="fu">facet_nested_wrap</span>(<span class="sc">~</span>Patientnumber<span class="sc">+</span>Bufferused, <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">scales =</span> <span class="st">&quot;free_x&quot;</span>) <span class="sc">+</span> </span>
<span id="cb6-18"><a href="03-Figure_3.html#cb6-18" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">&quot;bottom&quot;</span>, </span>
<span id="cb6-19"><a href="03-Figure_3.html#cb6-19" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(</span>
<span id="cb6-20"><a href="03-Figure_3.html#cb6-20" tabindex="-1"></a>          <span class="at">angle =</span> <span class="sc">-</span><span class="dv">45</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust=</span><span class="fl">0.1</span>),</span>
<span id="cb6-21"><a href="03-Figure_3.html#cb6-21" tabindex="-1"></a>        <span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="dv">0</span>,<span class="dv">5</span>,<span class="dv">0</span>,<span class="dv">0</span>, <span class="st">&quot;mm&quot;</span>),</span>
<span id="cb6-22"><a href="03-Figure_3.html#cb6-22" tabindex="-1"></a>        <span class="at">panel.spacing.x=</span><span class="fu">unit</span>(<span class="fl">0.2</span>, <span class="st">&quot;lines&quot;</span>)) <span class="sc">+</span></span>
<span id="cb6-23"><a href="03-Figure_3.html#cb6-23" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span> <span class="st">&quot;Sample name&quot;</span>, <span class="at">y =</span> <span class="st">&quot;relative abundance&quot;</span>) <span class="sc">+</span></span>
<span id="cb6-24"><a href="03-Figure_3.html#cb6-24" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill=</span><span class="fu">guide_legend</span>(<span class="at">ncol=</span><span class="dv">8</span>))</span>
<span id="cb6-25"><a href="03-Figure_3.html#cb6-25" tabindex="-1"></a></span>
<span id="cb6-26"><a href="03-Figure_3.html#cb6-26" tabindex="-1"></a><span class="co">#Save plot</span></span>
<span id="cb6-27"><a href="03-Figure_3.html#cb6-27" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">plot =</span> p,<span class="at">filename =</span> <span class="st">&quot;./figures/order_relabund_facet_buffer.png&quot;</span>, </span>
<span id="cb6-28"><a href="03-Figure_3.html#cb6-28" tabindex="-1"></a>       <span class="at">device =</span> <span class="st">&quot;png&quot;</span>, <span class="at">units =</span> <span class="st">&quot;mm&quot;</span>, <span class="at">height =</span> <span class="dv">200</span>, <span class="at">width =</span> <span class="dv">300</span>, </span>
<span id="cb6-29"><a href="03-Figure_3.html#cb6-29" tabindex="-1"></a>       <span class="at">dpi=</span><span class="dv">300</span>)</span></code></pre></div>
<p><img src="figures/order_relabund_facet_buffer.png" width="100%" style="display: block; margin: auto;" /></p>
<div id="percentage-of-bacteroides-and-firmicutes" class="section level3 hasAnchor" number="3.3.1">
<h3><span class="header-section-number">3.3.1</span> Percentage of Bacteroides and Firmicutes<a href="03-Figure_3.html#percentage-of-bacteroides-and-firmicutes" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="03-Figure_3.html#cb7-1" tabindex="-1"></a><span class="co">#Load in relative abundance phyloseq</span></span>
<span id="cb7-2"><a href="03-Figure_3.html#cb7-2" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&quot;./data/physeq_relabund&quot;</span>)</span>
<span id="cb7-3"><a href="03-Figure_3.html#cb7-3" tabindex="-1"></a></span>
<span id="cb7-4"><a href="03-Figure_3.html#cb7-4" tabindex="-1"></a><span class="co">#Aggregate taxa to order</span></span>
<span id="cb7-5"><a href="03-Figure_3.html#cb7-5" tabindex="-1"></a>physeq_phylum_relabund <span class="ot">&lt;-</span> <span class="fu">aggregate_taxa</span>(physeq_relabund, <span class="st">&#39;Phylum&#39;</span>)</span>
<span id="cb7-6"><a href="03-Figure_3.html#cb7-6" tabindex="-1"></a></span>
<span id="cb7-7"><a href="03-Figure_3.html#cb7-7" tabindex="-1"></a><span class="co">#Extract abundance table</span></span>
<span id="cb7-8"><a href="03-Figure_3.html#cb7-8" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">abundances</span>(physeq_phylum_relabund)</span>
<span id="cb7-9"><a href="03-Figure_3.html#cb7-9" tabindex="-1"></a></span>
<span id="cb7-10"><a href="03-Figure_3.html#cb7-10" tabindex="-1"></a><span class="co">#Create vector of relabund of bact and Firm added</span></span>
<span id="cb7-11"><a href="03-Figure_3.html#cb7-11" tabindex="-1"></a>Bac_firm_vec <span class="ot">&lt;-</span> df[<span class="st">&quot;Bacteroidetes&quot;</span>,] <span class="sc">+</span> df[<span class="st">&quot;Firmicutes&quot;</span>,]</span>
<span id="cb7-12"><a href="03-Figure_3.html#cb7-12" tabindex="-1"></a></span>
<span id="cb7-13"><a href="03-Figure_3.html#cb7-13" tabindex="-1"></a>samples <span class="ot">&lt;-</span> <span class="fu">names</span>(Bac_firm_vec[Bac_firm_vec <span class="sc">&lt;</span> <span class="fl">0.5</span>])</span>
<span id="cb7-14"><a href="03-Figure_3.html#cb7-14" tabindex="-1"></a></span>
<span id="cb7-15"><a href="03-Figure_3.html#cb7-15" tabindex="-1"></a>metadf <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">meta</span>(physeq_phylum_relabund))</span>
<span id="cb7-16"><a href="03-Figure_3.html#cb7-16" tabindex="-1"></a></span>
<span id="cb7-17"><a href="03-Figure_3.html#cb7-17" tabindex="-1"></a>meta_samples <span class="ot">&lt;-</span> metadf[metadf<span class="sc">$</span>Sample_name <span class="sc">%in%</span> samples,]</span></code></pre></div>
</div>
</div>
<div id="figure-3c" class="section level2 hasAnchor" number="3.4">
<h2><span class="header-section-number">3.4</span> Figure 3C<a href="03-Figure_3.html#figure-3c" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="03-Figure_3.html#cb8-1" tabindex="-1"></a><span class="co">#load in phyloseq object</span></span>
<span id="cb8-2"><a href="03-Figure_3.html#cb8-2" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&quot;./data/preprocess_physeq&quot;</span>)</span>
<span id="cb8-3"><a href="03-Figure_3.html#cb8-3" tabindex="-1"></a></span>
<span id="cb8-4"><a href="03-Figure_3.html#cb8-4" tabindex="-1"></a><span class="co">#Produce plot</span></span>
<span id="cb8-5"><a href="03-Figure_3.html#cb8-5" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">plot_richness</span>(physeq, <span class="at">x =</span> <span class="st">&quot;Bufferused&quot;</span>,</span>
<span id="cb8-6"><a href="03-Figure_3.html#cb8-6" tabindex="-1"></a>                   <span class="at">measures =</span> <span class="fu">c</span>(<span class="st">&quot;Observed&quot;</span>,<span class="st">&quot;Chao1&quot;</span>,<span class="st">&quot;Shannon&quot;</span>)) <span class="sc">+</span></span>
<span id="cb8-7"><a href="03-Figure_3.html#cb8-7" tabindex="-1"></a>  <span class="fu">geom_violin</span>() <span class="sc">+</span> </span>
<span id="cb8-8"><a href="03-Figure_3.html#cb8-8" tabindex="-1"></a>  ggforce<span class="sc">::</span><span class="fu">geom_sina</span>(<span class="at">alpha=</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb8-9"><a href="03-Figure_3.html#cb8-9" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">&quot;none&quot;</span>, </span>
<span id="cb8-10"><a href="03-Figure_3.html#cb8-10" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(</span>
<span id="cb8-11"><a href="03-Figure_3.html#cb8-11" tabindex="-1"></a>          <span class="at">angle =</span> <span class="sc">-</span><span class="dv">45</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust=</span><span class="fl">0.1</span>)) <span class="sc">+</span></span>
<span id="cb8-12"><a href="03-Figure_3.html#cb8-12" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span> <span class="st">&quot;Buffer used&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Measure&quot;</span>)</span>
<span id="cb8-13"><a href="03-Figure_3.html#cb8-13" tabindex="-1"></a></span>
<span id="cb8-14"><a href="03-Figure_3.html#cb8-14" tabindex="-1"></a><span class="co">#Save plot</span></span>
<span id="cb8-15"><a href="03-Figure_3.html#cb8-15" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">plot =</span> p, </span>
<span id="cb8-16"><a href="03-Figure_3.html#cb8-16" tabindex="-1"></a>       <span class="at">filename =</span> <span class="st">&quot;./figures/alpha_diversity_patient.png&quot;</span>,</span>
<span id="cb8-17"><a href="03-Figure_3.html#cb8-17" tabindex="-1"></a>       <span class="at">device =</span> <span class="st">&quot;png&quot;</span>, <span class="at">units =</span> <span class="st">&quot;mm&quot;</span>, <span class="at">height =</span> <span class="dv">80</span>, <span class="at">width =</span> <span class="dv">200</span>)</span></code></pre></div>
<p><img src="figures/alpha_diversity_patient.png" width="100%" style="display: block; margin: auto;" /></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="02-Phyloseqize.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="04-Figure_4.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": null,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": null,
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

</body>

</html>
